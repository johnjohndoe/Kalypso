<?xml version="1.0" encoding="ISO-8859-1"?>

<project name="KalypsoConfLocalhost: client"
         default="feature-and-plugins"
         basedir=".."
>
  <!-- set installationDir! -->
  <property name="kalypso.client.install"
            value="C:\\Programme\\KalypsoClient\\"
  />

  <!--
    value="P:\\Software\\KalypsoEnterpriseClient\\testing"
    value="P:\\Software\\KalypsoEnterpriseClient\\stable"
  />
  
-->
  <!-- set updatesite! -->
  <property name="kalypso.client.updatesite"
            value="C:\\Programme\\KalypsoClientUpdateSite\\"
  />

  <!-- Project full path -->
  <property name="project.path" value="${workspace}/KalypsoConfLocalhost" />
  <property name="dist" value="${workspace}/KalypsoConfLocalhost/deploy" />
  <property name="dist.client" value="${dist}/client" />


  <property name="eclipse.base" value="${workspace}/EclipseBaseClient" />

  <target name="prepare" description="Creates the build directory">
    <echo message="Creating the required directories...." />
    <mkdir dir="${dist}" />
    <mkdir dir="${dist.client}" />
  </target>

  <target name="clean" description="Removes the build directories">
    <delete dir="${dist.client}" />
  </target>

  <!-- copy the original eclipse stuff -->
  <target name="copy-eclipse-base"
          depends="prepare"
          description="Copy the base eclise files to the installation dir and others"
  >
    <copy todir="${kalypso.client.install}">
      <fileset dir="${eclipse.base}/eclipse-base"
               includes="*/**"
               excludes="**/CVS/**"
      />
    </copy>
  </target>

  <!-- copy the kalypso client configuration stuff -->
  <target name="copy-kalypso-custom"
          depends="copy-eclipse-base"
          description="Copy the kalypso configuration files to the installation dir and others"
  >

    <copy todir="${kalypso.client.install}">
      <fileset dir="${project.path}/deployable-client/client"
               includes="*/**"
               excludes="**/CVS/**"
      />
    </copy>
  </target>

  <!-- copy generated plugins and features to the installation dir  -->
  <target name="deploy-for-localhost"
          depends="copy-kalypso-custom"
          description="Copy generated plugins and features to the installation dir and others"
  >

    <echo message="Kalypso Client Installation in: ${kalypso.client.install}" />
    <echo message="hinweis: erst task feature-and-plugins ausführen, dann diese task starten"
    />

    <copy todir="${kalypso.client.install}">
      <fileset dir="${dist.client}" includes="*/**" excludes="**/CVS/**" />
    </copy>
  </target>


  <!-- deploy kalypso feature and kalypso plugins
	WICHTIG: da dieser Target pde.exportFeatures von Eclipse benutzt,
	sollte man es im selben JRE wie der Workspace ausführen
	-->
  <target name="feature-and-plugins"
          depends="prepare"
          description="deploy kalypso feature and plugins"
  >
    <pde.exportFeatures features="org.kalypso.enterprise"
                        destination="${dist.client}"
                        exportType="directory"
                        exportSource="false"
    />
  </target>

  <target name="feature-and-plugins-TUHH-FeatureNA"
          depends="prepare"
          description="deploy kalypso feature and plugins TUHH-FeatureNA"
  >

    <pde.exportFeatures features="org.kalypso.enterprise.na"
                        destination="${dist.client}"
                        exportType="directory"
                        exportSource="false"
    />
  </target>

  <target name="feature-and-plugins-as-updatesite"
          depends="prepare"
          description="deploy kalypso feature and plugins"
  >
    <pde.exportFeatures features="org.kalypso.enterprise"
                        destination="${kalypso.client.updatesite}"
                        exportType="update"
                        exportSource="false"
    />
  </target>


</project>
