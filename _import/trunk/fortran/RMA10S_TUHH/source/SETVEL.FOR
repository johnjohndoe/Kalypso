C     Last change:  MD    8 Jun 2009    7:50 pm
CIPK  LAST UPDATE APR 4 1997 USE OLD VALUES OF CONCENTRATION FOR SETTLING
      SUBROUTINE SETVEL
C           THIS SUBROUTINE SETS THE SETTLING VELOCITIES FOR EACH
C       NODE, AT EACH TIMESTEP THAT THE CODE ARRAY ISVL HAS A
C       NON-ZERO VALUE.
C       IF ISVL=1 SETTLING VELOCITIES ARE SET TO A CONSTANT VSST
C       WHICH HAS BEEN READ IN. IF ISVL=2 A  SET. VEL MODEL
C       IS USED TO GENERATE THE VALUES.
C----------------------------------------------------------------------
C
      USE BLK10MOD
      USE BLKSEDMOD
C-
      IF(ISVL .EQ. 1) THEN
        DO I=1,NP
          VS(I)=VSST
        ENDDO

      ELSEIF(ISVL.EQ.2 .or. ISVL.EQ.3) THEN
C
C....    THIS IS THE PLACE TO PUT IN SOME GRAND SET. VEL. MODEL
        K=LSS
        DO  I=1,NP
          IF(VEL(6,I) .LT. CRCON1(I)) THEN
            VS(I)=VSS1(I)
          ELSEIF(VEL(6,I) .GT. CRCON2(I)) THEN
            VS(I)=VSS2(I)
          ELSE
            VS(I)=VSK(I)* (VEL(6,I)**EXP2(I))
          ENDIF
        ENDDO

      ENDIF

      RETURN
      END
