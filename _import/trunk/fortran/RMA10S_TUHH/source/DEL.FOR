C     Last change:  IPK   3 Oct 98    4:24 pm

      SUBROUTINE DEL
      USE BLK10MOD
      USE BLKDRMOD
      SAVE
C-
CIPK AUG05      INCLUDE 'BLK10.COM'
CIPK AUG05      INCLUDE 'BLKDR.COM'
C-
C     DIMENSION IMATO(MEL),NDRYO(MNP),IPT(MNP)
C-
       DATA IENT/0/
C-
C......SUBROUTINE TO DROP OUT ELEMENTS
C-
      IF(IENT .EQ. 0) THEN
        DO 180 N=1,NE
          IMATO(N)=IMAT(N)
  180   CONTINUE
        DO 185 N=1,NP
          NDRYO(N)=NDRY(N)
  185   CONTINUE
      ENDIF
      IENT=1
C-
C......RESET MAT TYPES
C-
      DO 250 N=1,NE
CIPK OCT98 CONVERT TO F90
        IMAT(N)=ABS(IMAT(N))
        IF(IMAT(N) .EQ. 0) GO TO 250
        NCN=NCORN(N)
        IF(NCN .LT. 9  .AND. IMAT(N) .LT. 1000) THEN
          DO 230 M=1,NCN,2
CIPK OCT98 CONVERT TO F90
            L=ABS(NOP(N,M))
            IF(VEL(3,L) .GT. DSETD) GO TO 230
            IF(NDRY(L) .LT. 1) GO TO 205
            IF(VEL(3,L) .GT. DSET) GO TO 230
CIPK OCT98 CONVERT TO F90
  205       IMAT(N)=-ABS(IMAT(N))
  230     CONTINUE
        ENDIF
  250 CONTINUE
      DO 300 N=1,NP
  300 NDRY(N)=2
      DO 330 N=1,NE
        IF(IMAT(N) .LT. 1) GO TO 330
        NCN=NCORN(N)
C        IF(NCN .LT. 9  .AND.  IMAT(N) .LT. 1000) THEN
          DO 320 M=1,NCN
CIPK OCT98 CONVERT TO F90
            L=ABS(NOP(N,M))
  320     NDRY(L)=1
C        ENDIF
  330 CONTINUE
      DO 390 L=1,NP
        IF(NDRY(L) .NE. 1) THEN
          DO 380 IA=1,2
            VEL(IA,L)=0.
  380     CONTINUE
        ENDIF
  390 CONTINUE
      WRITE(LOUT,6005)
 6005 FORMAT(' THE FOLLOWING ELEMENTS HAVE BEEN ELIMINATED')
      NR=0
      IFLAG=1
      DO 405 N=1,NE
        IF(IMAT(N) .GE. 0) GO TO 405
        IF(IMATO(N) .LT. 0) GO TO 405
        NR=NR+1
        IPT(NR)=N
  405 CONTINUE
      IF(NR .GT. 0) IFLAG=2
      IF(NR .GT. 0) WRITE(LOUT,6030) (IPT(N),N=1,NR)
 6030 FORMAT(10I5)
      WRITE(LOUT,6007)
 6007 FORMAT(' THE FOLLOWING ELEMENTS HAVE BEEN ADDED')
      NR=0
      DO 410 N=1,NE
        IF(IMAT(N) .LE. 0) GO TO 410
        IF(IMATO(N) .GT. 0) GO TO 410
        NR=NR+1
        IPT(NR)=N
  410 CONTINUE
      IF(NR .GT. 0) IFLAG=2
      IF(NR .GT. 0) WRITE(LOUT,6030) (IPT(N),N=1,NR)
      WRITE(LOUT,6008)
 6008 FORMAT(' THE FOLLOWING NODES HAVE BEEN ELIMINATED')
      NR=0
      DO 415 N=1,NP
        IF(NDRY(N) .EQ. 1) GO TO 415
        IF(NDRYO(N) .NE. 1) GO TO 415
        NR=NR+1
        IPT(NR)=N
  415 CONTINUE
      IF(NR .GT. 0) IFLAG=2
      IF(NR .GT. 0) WRITE(LOUT,6030) (IPT(N),N=1,NR)
      WRITE(LOUT,6009)
 6009 FORMAT(' THE FOLLOWING NODES HAVE BEEN ADDED')
      NR=0
      DO 420 N=1,NP
        IF(NDRY(N) .NE. 1) GO TO 420
        IF(NDRYO(N) .EQ. 1) GO TO 420
        NR=NR+1
        IPT(NR)=N
  420 CONTINUE
      IF(NR .GT. 0) IFLAG=2
      IF(NR .GT. 0) WRITE(LOUT,6030) (IPT(N),N=1,NR)
      DO 450 N=1,NE
        IMATO(N)=IMAT(N)
  450 CONTINUE
      DO 500 N=1,NP
        NDRYO(N)=NDRY(N)
  500 CONTINUE
      RETURN
      END
