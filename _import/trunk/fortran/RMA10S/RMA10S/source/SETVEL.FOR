CIPK  LAST UPDATE APR 4 1997 USE OLD VALUES OF CONCENTRATION FOR SETTLING
      SUBROUTINE SETVEL
C           THIS SUBROUTINE SETS THE SETTLING VELOCITIES FOR EACH
C       NODE, AT EACH TIMESTEP THAT THE CODE ARRAY ISVL HAS A
C       NON-ZERO VALUE.
C       IF ISVL=1 SETTLING VELOCITIES ARE SET TO A CONSTANT VSST
C       WHICH HAS BEEN READ IN. IF ISVL=2 A  SET. VEL MODEL
C       IS USED TO GENERATE THE VALUES.
C----------------------------------------------------------------------
C
      USE BLK10MOD
      USE BLKSEDMOD
cipk aug05      INCLUDE 'BLK10.COM'
CIPK AUG05      INCLUDE 'BLKSED.COM'
C-
      IF(ISVL .EQ. 1) THEN
        DO I=1,NP
          VS(I)=VSST
        ENDDO
      ELSE
C
C....    THIS IS THE PLACE TO PUT IN SOME GRAND SET. VEL. MODEL
C
        K=LSS
        DO  I=1,NP
CIPK APR97           IF(TCON(K,I) .LT. CRCON1) THEN
          IF(VEL(6,I) .LT. CRCON1) THEN
            VS(I)=VSS1
CIPK APR97          ELSEIF(TCON(K,I) .GT. CRCON2) THEN
          ELSEIF(VEL(6,I) .GT. CRCON2) THEN
            VS(I)=VSS2
          ELSE
CIPK APR97            VS(I)=VSK*TCON(K,I)**EXP2
            VS(I)=VSK*VEL(6,I)**EXP2
          ENDIF
        ENDDO

      ENDIF
      RETURN
      END
