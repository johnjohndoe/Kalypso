<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.2"?>
<plugin>
   
   <extension
         id="org.kalypso.kalypso1d2d.pjt.Kalypso1d2dProjectPlugin"
         point="org.eclipse.core.runtime.applications">
      <application>
         <run
               class="org.kalypso.kalypso1d2d.pjt.Kalypso1d2dProjectPlugin">
         </run>
      </application>
   </extension>
   
   
   <!-- Project extensions -->
   <extension
      point="org.eclipse.core.resources.natures"
      id="org.kalypso.kalypso1d2d.pjt.Kalypso1D2DProjectNature"
      name="Kalypso1D2DProjectNature">
      <runtime>
         <run class="org.kalypso.kalypso1d2d.pjt.Kalypso1D2DProjectNature"/>
      </runtime>
   </extension>

	<extension
       point="org.eclipse.ui.newWizards">
		<category
            id="org.kalypso.wizard.Create1d2dpjt"
            name="1D-2D Modell"
            parentCategory="org.kalypso.ui.newwizards.kalypso"/>
		<wizard
        category="org.kalypso.ui.newwizards.kalypso/org.kalypso.wizard.Create1d2dpjt"
        class="org.kalypso.kalypso1d2d.pjt.Kalypso1D2DNewProjectWizard"
        icon="icons/kalypso1d2d.png"
        id="org.kalypso.kalypso1d2d.pjt.Kalypso1D2DNewProjectWizard"
        name="Kalypso 1D-2D gekoppeltes Modell"
        project="true">
		<description>
				Creates a new project
		</description>
		</wizard>
		<wizard
            class="org.kalypso.ui.wizards.imports.baseMap.ImportBaseMapWizard"
            icon="icons/kalypso_gmt.gif"
            id="org.kalypso.ui.wizards.imports.baseMap.ImportBaseMapWizard"
            name="BaseMap"
            project="false"/>
	  	<category
            id="org.kalypso.kalypsosimulationmodel.ui.shapeimportwizards"
            name="Kalypso import wizards"/>
      	<wizard
            category="org.kalypso.kalypsosimulationmodel.ui.shapeimportwizards"
            class="org.kalypso.ui.wizards.imports.roughness.ImportWizard"
            icon="icons/kalypso_gmt.gif"
            id="org.kalypso.ui.wizards.imports.roughness.ImportWizard"
            name="Roughness import wizard"
            project="false"/>
      	<wizard
            class="org.kalypso.ui.wizards.imports.elevationmodel.ImportElevationWizard"
            id="org.kalypso.ui.wizards.imports.elevationmodel.ImportElevationWizard"
            name="ElevationWizard"
            project="false"/>
      	<wizard
            class="org.kalypso.ui.wizards.imports.observation.ImportObservationWizard"
            id="org.kalypso.ui.wizards.imports.observation.ImportObservationWizard"
            name="Observation load"/>            
        <wizard
              class="org.kalypso.wizards.import1d2d.ImportWizard"
              icon="icons/elcl16/1d2d_edit_protocol_view.gif"
              id="org.kalypso.wizards.import1d2d.ImportWizard"
              name="Import 1D2D"
              project="false"/>          
	</extension>	
	<!-- perspectives-->
	<extension
         point="org.eclipse.ui.perspectives">
      <perspective
            class="org.kalypso.kalypso1d2d.pjt.perspective.Perspective"
            icon="icons/kalypso1d2d.png"
            id="org.kalypso.kalypso1d2d.pjt.perspective.Perspective"
            name="Kalypso 1d2d">
      </perspective>      
   </extension>
   
   <extension
         name="Workflow Views"
         point="org.eclipse.ui.views">
       <view
             allowMultiple="false"
             class="org.kalypso.kalypso1d2d.pjt.views.WorkflowView"
             icon="icons/nuvola_select/loop.png"
             id="org.kalypso.kalypso1d2d.pjt.views.WorkflowView"
             name="Aktivitäten"/>
       <view
             allowMultiple="false"
             class="org.eclipse.ui.navigator.CommonNavigator"
             icon="icons/tree.gif"
             id="org.kalypso.kalypso1d2d.pjt.views.ScenarioView"
             name="Szenarien"/>         
   </extension>
   
   	
     
     <extension point="org.eclipse.ui.handlers">
     
     <!--*** Element2D context handler ***-->
		 <handler
		       class="org.kalypso.ogc.gml.map.widgets.SelectWidgetHandler"
		       commandId="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand#Element2D">
		    <activeWhen>   
		       <with variable="activeContexts">
		          <iterate operator="or">
		             <equals value="{http://www.tu-harburg.de/wb/kalypso/schemata/1d2d}PolyElement"/>
		          </iterate>
		       </with>
		     </activeWhen>
		 </handler>
		 
     <!--*** Element1D context handler ***-->
		 <handler
		       class="org.kalypso.ogc.gml.map.widgets.SelectWidgetHandler"
		       commandId="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand#Element1D">
		    <activeWhen>   
		       <with variable="activeContexts">
		          <iterate operator="or">
		             <equals value="{http://www.tu-harburg.de/wb/kalypso/schemata/1d2d}Element1D"/>
		          </iterate>
		       </with>
		    </activeWhen>
		 </handler>
		 
     <!--*** _FlowRelationship (Parameters1D) context handler ***-->		 
		 <handler
	           class="org.kalypso.ogc.gml.map.widgets.SelectWidgetHandler"
	           commandId="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand#Parameters1D">
		     <activeWhen>
		         <with variable="activeContexts">
		            <iterate operator="or">
		               <equals value="{http://www.tu-harburg.de/wb/kalypso/schemata/simulationbase}_FlowRelationship"/>
		            </iterate>
		         </with>
		     </activeWhen>
		 </handler>
	
	 <!--*** BoundaryCondition context handler ***-->	 
		 <handler
		       class="org.kalypso.ogc.gml.map.widgets.SelectWidgetHandler"
         commandId="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand#NodalBCDef">
              <activeWhen>
                 <with variable="activeContexts">
                    <iterate operator="or">
                       <equals value="{http://www.tu-harburg.de/wb/kalypso/schemata/operationalmodel}BoundaryCondition"/>
                    </iterate>
                 </with>
              </activeWhen>
         </handler>
		 <handler
		       class="org.kalypso.ogc.gml.map.widgets.SelectWidgetHandler"
		       commandId="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand#ContinuityLine">
		    <activeWhen>   
		        <with variable="activeContexts">
		          <iterate operator="or">
		             <equals value="{http://www.tu-harburg.de/wb/kalypso/schemata/1d2d}ContinuityLine"/>
		          </iterate>
		       </with>
		    </activeWhen>
		 </handler>

 	 <!--*** handlers for scenario management ***-->			   
	     <handler
            class="org.kalypso.kalypso1d2d.pjt.actions.AddScenarioHandler"
            commandId="http://www.tu-harburg.de/wb/kalypso/kb/workflow/test#AddScenario"/>      	 
	     <handler
	           class="org.kalypso.kalypso1d2d.pjt.actions.RemoveScenarioHandler"
	           commandId="http://www.tu-harburg.de/wb/kalypso/kb/workflow/test#RemoveScenario"/>	 
	     <handler
            class="org.kalypso.kalypso1d2d.pjt.actions.ActivateScenarioHandler"
            commandId="http://www.tu-harburg.de/wb/kalypso/kb/workflow/test#ActivateScenario"/>      	 	               

 	 <!--*** import handlers ***-->
	     <handler
	           class="org.kalypso.kalypso1d2d.pjt.actions.ImportElevationHandler"
	           commandId="http://www.tu-harburg.de/wb/kalypso/kb/workflow/test#ElevLoad"/>			   	           
	     <handler
	           class="org.kalypso.kalypso1d2d.pjt.actions.ImportProfileHandler"
	           commandId="http://www.tu-harburg.de/wb/kalypso/kb/workflow/test#ProfileImport"/>	
	           
 	 <!--*** general net editing handler ***-->	     
	     
 	 <!--*** 1D-editing handlers ***-->	     
	     <handler
	           class="org.kalypso.kalypso1d2d.pjt.actions.ImportWSPMHandler"
	           commandId="http://www.tu-harburg.de/wb/kalypso/kb/workflow/test#Net1DImportWspm"/>
	     <handler
               class="org.kalypso.kalypso1d2d.pjt.actions.AddProfileToMapHandler"
               commandId="http://www.tu-harburg.de/wb/kalypso/kb/workflow/test#AddProfileNetworkToMap"/>	           	           
	     
 	 <!--*** 2D-editing handlers ***-->	     
	     <handler
	           commandId="http://www.tu-harburg.de/wb/kalypso/kb/workflow/test#Chan2DGen">
           <class class="org.kalypso.ogc.gml.map.widgets.SelectWidgetHandler">
	           <parameter
	                 name="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand.widget"
	                 value="org.kalypso.kalypsomodel1d2d.ui.map.channeledit.CreateMainChannelWidget"/>
	           <parameter
	                 name="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand.plugin"
	                 value="org.kalypso.model1d2d"/>
           </class>
	     </handler>
	     <handler
	           commandId="http://www.tu-harburg.de/wb/kalypso/kb/workflow/test#BandGen">
           <class class="org.kalypso.ogc.gml.map.widgets.SelectWidgetHandler">
	           <parameter
	                 name="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand.widget"
	                 value="org.kalypso.kalypsomodel1d2d.ui.map.grid.CreateGridWidget"/>
	           <parameter
	                 name="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand.plugin"
	                 value="org.kalypso.model1d2d"/>
           </class>
	     </handler>
	     
	     <!-- Roughness correction -->
	     <handler
	           commandId="http://www.tu-harburg.de/wb/kalypso/kb/workflow/test#roughness_correction_modelling">
           <class class="org.kalypso.ogc.gml.map.widgets.SelectWidgetHandler">
	           <parameter
	                 name="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand.widget"
	                 value="org.kalypso.kalypsomodel1d2d.ui.map.roughness_cor.RoughnessCorrectionWidget"/>
	           <parameter
	                 name="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand.plugin"
	                 value="org.kalypso.model1d2d"/>
           </class>
	     </handler>
	     
	     <handler
	     	   commandId="http://www.tu-harburg.de/wb/kalypso/kb/workflow/test#AssignElevs">
           <class class="org.kalypso.ogc.gml.map.widgets.SelectWidgetHandler">
	           <parameter
	                 name="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand.widget"
	                 value="org.kalypso.kalypsomodel1d2d.ui.map.temsys.ApplyElevationWidget"/>
	           <parameter
	                 name="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand.plugin"
	                 value="org.kalypso.model1d2d"/>
           </class>
	     </handler>
 	 <!--*** 1D/2D transition handlers CreateJunctionContext1dToCLineFromSelectedEdges ***-->	     	     	     	     	     	     	     
	     <!--handler commandId="http://www.tu-harburg.de/wb/kalypso/kb/workflow/test#SetEltLineTrans">
	           <class class="org.kalypso.ogc.gml.map.widgets.SelectWidgetHandler">
		           <parameter
		                 name="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand.widget"
		                 value="org.kalypso.kalypsomodel1d2d.ui.map.junction1d2d.CreateJunctionFromClAnd1DEleWidget"/>
		           <parameter
		                 name="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand.plugin"
		                 value="org.kalypso.model1d2d"/>
	        </class>
	     </handler-->	
	     
	    <handler commandId="http://www.tu-harburg.de/wb/kalypso/kb/workflow/test#SetEltLineTrans">
	           <class class="org.kalypso.ogc.gml.map.widgets.SelectWidgetHandler">
		           <parameter
		                 name="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand.widget"
		                 value="org.kalypso.kalypsomodel1d2d.ui.map.junction1d2d.CreateJunctionContext1dToCLineFromSelectedEdges"/>
		           <parameter
		                 name="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand.plugin"
		                 value="org.kalypso.model1d2d"/>
	        </class>
	     </handler>	
	          
	     <handler commandId="http://www.tu-harburg.de/wb/kalypso/kb/workflow/test#SetEltEltTrans">
	           <class class="org.kalypso.ogc.gml.map.widgets.SelectWidgetHandler">
		           <parameter
		                 name="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand.widget"
		                 value="org.kalypso.kalypsomodel1d2d.ui.map.junction1d2d.CreateJunctionContext1DTo2DFromSelectedEdges"/>
		           <parameter
		                 name="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand.plugin"
		                 value="org.kalypso.model1d2d"/>
	        </class>
	     </handler>
      <handler commandId="http://www.tu-harburg.de/wb/kalypso/kb/workflow/test#RoughnessFENETColor">
         <class class="org.kalypso.ogc.gml.map.widgets.SelectWidgetHandler">
            <parameter
                  name="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand.widget"
                  value="org.kalypso.kalypsomodel1d2d.ui.map.fenetRoughness.ApplyColorOnFENETWidget"/>
            <parameter
                  name="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand.plugin"
                  value="org.kalypso.model1d2d"/>
         </class>
      </handler>
      <handler
            class="org.kalypso.kalypso1d2d.pjt.actions.StartCalculationHandler"
            commandId="http://www.tu-harburg.de/wb/kalypso/kb/workflow/test#StartCalculation"/>
	     
 	 <!--*** roughness handlers ***-->	     	     	     	     	     	     
	     
 	 <!--*** boundary conditions handlers ***-->	     	     	     	     	     	     	     

 	 <!--*** calculation handlers ***-->	     	     	     	     	     	     	     
	</extension>
    
   <extension
           point="org.eclipse.ui.intro.configExtension">
        <configExtension
              configId="org.kalypso.model.product.configId"
              content="content/ext.xml"/>
   </extension>
   <extension
         point="de.renew.workflow.model.contextHandlerFactories">
      <contextHandlerFactory
            class="org.kalypso.kalypso1d2d.pjt.actions.KalypsoContextHandlerFactory"
            id="kalypsoContextHandlerFactory"/>
   </extension>
   <extension
         point="org.eclipse.ui.navigator.viewer">
      <viewer
            popupMenuId="org.kalypso.kalypso1d2d.pjt.views.ScenarioView.menu"
            viewerId="org.kalypso.kalypso1d2d.pjt.views.ScenarioView">
      </viewer>
      <viewerContentBinding viewerId="org.kalypso.kalypso1d2d.pjt.views.ScenarioView">
         <includes>
            <contentExtension pattern="org.eclipse.ui.navigator.resourceContent"/>
            <contentExtension pattern="org.kalypso.kalypso1d2d.pjt.navigator.filters.*"/>
            <contentExtension pattern="org.kalypso.kalypso1d2d.pjt.navigator.ScenarioContent"/>
         </includes>
      </viewerContentBinding>
   </extension>
   <extension
         point="org.eclipse.ui.navigator.navigatorContent">
      <commonFilter
            activeByDefault="true"
            description="Nur Kalypso1d2d-Projekte anzeigen"
            id="org.kalypso.kalypso1d2d.pjt.navigator.filters.Kalypso1d2dProjects"
            name="Nur Kalypso1d2d-Projekte anzeigen">
         <filterExpression>
    	    <and>
				<instanceof value="org.eclipse.core.resources.IProject"/>        
				<not>
					<test
                        property="org.eclipse.core.resources.projectNature"
                        value="org.kalypso.kalypso1d2d.pjt.Kalypso1D2DProjectNature"/>
                </not>
	        </and>
         </filterExpression>
      </commonFilter>
      <navigatorContent
            activeByDefault="true"
            contentProvider="org.kalypso.kalypso1d2d.pjt.views.contentprov.ScenarioContentProvider"
            icon="icons/nuvola_select/ledblue.png"
            id="org.kalypso.kalypso1d2d.pjt.navigator.ScenarioContent"
            labelProvider="org.kalypso.kalypso1d2d.pjt.views.contentprov.ScenarioLabelProvider"
            name="Szenario"
            priority="normal">
         <triggerPoints>
            <or>
	        	<and>
					<instanceof value="org.eclipse.core.resources.IProject"/>        
					<test
                        property="org.eclipse.core.resources.projectNature"
                        value="org.kalypso.kalypso1d2d.pjt.Kalypso1D2DProjectNature"/>
		        </and>
		        <instanceof value="org.kalypso.afgui.scenarios.Scenario"/>
            </or>
         </triggerPoints>
         <possibleChildren>
            <or>
               <instanceof value="org.kalypso.afgui.scenarios.Scenario"/>
            </or>
         </possibleChildren>
      </navigatorContent>
      <commonFilter
            activeByDefault="true"
            description="Ressourcen ausblenden"
            id="org.kalypso.kalypso1d2d.pjt.navigator.filters.StarDotStarResources"
            name="Ressourcen ausblenden">
         <filterExpression>
     		<or>
 	        	<and>
					<instanceof value="org.eclipse.core.resources.IFolder"/>
    	     	</and>
 				<test
    	            forcePluginActivation="true"
        	        property="org.eclipse.core.resources.name"
            	    value=".*"/>    	     	
     		</or>
         </filterExpression>
      </commonFilter>
   </extension>
   <extension
         point="org.eclipse.ui.popupMenus">
      <viewerContribution
            id="org.kalypso.kalypso1d2d.pjt.views.ScenarioView.popupActions"
            targetID="org.kalypso.kalypso1d2d.pjt.views.ScenarioView.menu">
         <action
               enablesFor="?"
               icon="icons/nuvola_select/edit_add.png"
               id="org.kalypso.kalypso1d2d.pjt.actions.AddScenario"
               label="Szenario hinzufügen"
               menubarPath="group.edit"
               tooltip="Ein neues Szenario hinzufügen">
           <class class="org.kalypso.ui.GenericCommandActionDelegate">
        	<parameter name="commandId" 
                 value="http://www.tu-harburg.de/wb/kalypso/kb/workflow/test#AddScenario"/>
           </class>
         </action>
      </viewerContribution>
      <objectContribution
            adaptable="false"
            id="org.kalypso.kalypso1d2d.pjt.views.ScenarioView.actions"
            objectClass="org.kalypso.afgui.scenarios.Scenario">
         <action
               enablesFor="1"
               helpContextId="org.eclipse.ui.edit.delete"
               icon="icons/nuvola_select/edit_remove.png"
               id="org.kalypso.kalypso1d2d.pjt.actions.RemoveScenario"
               label="Szenario löschen"
               menubarPath="group.edit"
               tooltip="Das gewählte Szenario löschen">
           <class class="org.kalypso.ui.GenericCommandActionDelegate">
            	<parameter name="commandId" 
                     value="http://www.tu-harburg.de/wb/kalypso/kb/workflow/test#RemoveScenario"/>
           </class>
         </action>
         <action
               enablesFor="1"
               icon="icons/activate.gif"
               id="org.kalypso.kalypso1d2d.pjt.actions.ActivateScenario"
               label="Szenario aktivieren"
               menubarPath="group.edit"
               tooltip="Das gewählte Szenario aktivieren">
           <class class="org.kalypso.ui.GenericCommandActionDelegate">
            	<parameter name="commandId" 
                     value="http://www.tu-harburg.de/wb/kalypso/kb/workflow/test#ActivateScenario"/>
           </class>
         </action>
      </objectContribution>
      <objectContribution
            adaptable="true"
            id="org.kalypso.kalypso1d2d.pjt.natureActions"
            objectClass="org.eclipse.core.resources.IProject">
         <filter
               name="nature"
               value="org.kalypso.kalypso1d2d.pjt.Kalypso1D2DProjectNature"/>
         <action
               enablesFor="1"
               icon="icons/nuvola_select/kaboodleloop.png"
               id="org.kalypso.kalypso1d2d.pjt.natureActions.NewProject"
               label="Verbinden"
               tooltip="Projekt mit dem Workflowserver verbinden">
			<class class="org.kalypso.ui.GenericCommandActionDelegate">
      			<parameter name="commandId" 
                 	value="http://www.tu-harburg.de/wb/kalypso/kb/workflow/test#NewProject"/>
   			</class>               
         </action>
      </objectContribution>
   </extension>
   <extension
         point="org.eclipse.ui.commands">
      <command
            categoryId="de.renew.workflow.tasks.category"
            id="http://www.tu-harburg.de/wb/kalypso/kb/workflow/test#NewProject"
            name="Projekt mit Workflowserver verbinden"/>
	  <command
            categoryId="de.renew.workflow.tasks.category"
            id="http://www.tu-harburg.de/wb/kalypso/kb/workflow/test#DeleteProject"
            name="Projekt von Workflowserver trennen"/>                     
      <command
            categoryId="de.renew.workflow.tasks.category"
            id="http://www.tu-harburg.de/wb/kalypso/kb/workflow/test#AddScenario"
            name="Szenario hinzufügen"/>
      <command
            categoryId="de.renew.workflow.tasks.category"
            id="http://www.tu-harburg.de/wb/kalypso/kb/workflow/test#RemoveScenario"
            name="Szenario löschen"/>
      <category
            description="Category for workflow tasks"
            id="de.renew.workflow.tasks.category"
            name="de.renew.workflow.tasks.category"/>
      <category
            description="Category for workflow task groups"
            id="de.renew.workflow.taskgroups.category"
            name="de.renew.workflow.taskgroups.category"/>
   </extension>
   
   <extension
         point="org.kalypso.deegree.functionProperty">
      <function
            class="org.kalypso.ui.wizards.imports.roughness.LinkedFeaturePropertyFunction"
            id="org.kalypso.ui.wizards.imports.roughness.LinkedFeaturePropertyFunction"
            name="Linked-Feature-Property-Fetcher"/>
      <function
            class="org.kalypso.ui.wizards.imports.roughness.RougnessValuesPropertyFunction"
            id="org.kalypso.ui.wizards.imports.roughness.RougnessValuesPropertyFunction"
            name="ComputeMergedRougnessProperties"/>
      <function
            class="org.kalypso.ui.wizards.imports.roughness.RougnessValuesPropertyFunction"
            id="org.kalypso.ui.wizards.imports.roughness.RougnessValuesPropertyFunction"
            name="RougnessValuesPropertyFunction"/>
   </extension>
   <extension
         point="org.kalypso.deegree.gmlWorkspaceListener">
      <listener
            class="org.kalypso.ui.wizards.imports.roughness.RoughnessStyleUpdater"
            id="org.kalypso.ui.wizards.imports.roughness.RoughnessStyleUpdater"
            name="RoughnessStyleUpdater"/>
   </extension>
</plugin>
