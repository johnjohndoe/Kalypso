<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.2"?>
<plugin>
   <extension
         point="org.kalypso.contribs.java.urlCatalog">
      <catalog
            class="org.kalypso.model.flood.schema.UrlCatalogModelFlood"
            id="org.kalypso.model.flood.schema.UrlCatalogModelFlood"/>
   </extension>
    <extension
          point="org.kalypso.simulation.core.simulation">
       <simulation
            catalogClass="org.kalypso.model.flood.schema.UrlCatalogModelFlood"
             simulationClass="org.kalypso.model.flood.core.SimulationKalypsoFlood"
             typeID="KalypsoFloodSimulation">
       </simulation>
    </extension>
   <extension
         point="org.kalypso.core.catalogContribution">
      <catalogContribution
            class="org.kalypso.model.flood.ui.catalog.FloodModelCatalogContribution"
            name="Flood Model Catalog"/>
   </extension>
   <extension
         point="de.renew.workflow.model.workflowSystem">
      <workflowSystem
            definition="etc/workflow.xml"
            id="org.kalypso.model.flood.workflow"
            name="Flood-Modeller-Workflow">
      </workflowSystem>
   </extension>
   <extension
         point="org.eclipse.ui.handlers">

      <!-- Handler for workflow.xml: non-existing commandId is ok here --> 
      <handler
            commandId="org.kalypso.model.flood.ManageWaterlevelData">
         <class
               class="org.kalypso.ogc.gml.map.widgets.SelectWidgetHandler">
            <parameter
                  name="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand.widget"
                  value="org.kalypso.model.flood.ui.map.EventManagementWidget">
            </parameter>
         </class>
      </handler>
      <handler
            class="org.kalypso.model.flood.handlers.VisualizeGridDataHandler"
            commandId="org.kalypso.model.flood.ManageDTMData">
      </handler>
      <handler
            class="org.kalypso.model.flood.handlers.PolygonEditingHandler"
            commandId="org.kalypso.model.flood.PolygonEditing">
      </handler>
      <handler
            class="org.kalypso.model.flood.handlers.ProcessFloodModelHandler"
            commandId="org.kalypso.model.flood.ProcessFloodModel">
      </handler>
      <handler
            class="org.kalypso.model.flood.handlers.VisualizeDepthDataHandler"
            commandId="org.kalypso.model.flood.VisualizeDepthData">
      </handler>
      <handler
            class="org.kalypso.model.flood.handlers.GenerateRiskModelHandler"
            commandId="org.kalypso.model.flood.GenerateRiskModel">
      </handler>

      <!-- Flood-Polygons -->
      <handler
            commandId="org.kalypso.model.flood.command.deleteFloodPolygon">
         <activeWhen>
            <reference
                  definitionId="org.kalypso.model.flood.expression.def.abstractFloodPolygonContextActive">
            </reference>
         </activeWhen>
         <class
               class="org.kalypso.ogc.gml.map.widgets.SelectWidgetHandler">
            <parameter
                  name="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand.widget"
                  value="org.kalypso.model.flood.ui.map.DeleteFloodPolygonWidget">
            </parameter>
         </class>
      </handler>
      <handler
            commandId="org.kalypso.model.flood.command.editFloodPolygon">
         <activeWhen>
            <reference
                  definitionId="org.kalypso.model.flood.expression.def.abstractFloodPolygonContextActive">
            </reference>
         </activeWhen>
         <class
               class="org.kalypso.ogc.gml.map.widgets.SelectWidgetHandler">
            <parameter
                  name="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand.widget"
                  value="org.kalypso.model.flood.ui.map.EditFloodPolygonWidget">
            </parameter>
         </class>
      </handler>
      <handler
            commandId="org.kalypso.model.flood.command.createExtrapolationPolygon">
         <activeWhen>
            <reference
                  definitionId="org.kalypso.model.flood.expression.def.abstractFloodPolygonContextActive">
            </reference>
         </activeWhen>
         <class
               class="org.kalypso.ogc.gml.map.widgets.SelectWidgetHandler">
            <parameter
                  name="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand.widget"
                  value="org.kalypso.model.flood.ui.map.CreateFloodPolygonExtrapolationWidget">
            </parameter>
         </class>
      </handler>
      <handler
            commandId="org.kalypso.model.flood.command.createClipPolygon">
         <activeWhen>
            <reference
                  definitionId="org.kalypso.model.flood.expression.def.abstractFloodPolygonContextActive">
            </reference>
         </activeWhen>
         <class
               class="org.kalypso.ogc.gml.map.widgets.SelectWidgetHandler">
            <parameter
                  name="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand.widget"
                  value="org.kalypso.model.flood.ui.map.CreateFloodPolygonClipWidget">
            </parameter>
         </class>
      </handler>
      <handler
            commandId="org.kalypso.model.flood.command.createVolumePolygon">
         <activeWhen>
            <reference
                  definitionId="org.kalypso.model.flood.expression.def.abstractFloodPolygonContextActive">
            </reference>
         </activeWhen>
         <class
               class="org.kalypso.ogc.gml.map.widgets.SelectWidgetHandler">
            <parameter
                  name="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand.widget"
                  value="org.kalypso.model.flood.ui.map.CreateFloodPolygonVolumeWidget">
            </parameter>
         </class>
      </handler>
   </extension>
   <extension
         point="org.kalypso.afgui.scenarioData">
      <dataSet
            id="org.kalypso.model.flood.scenarioDataScope">
         <scenarioDatum
               classKey="org.kalypso.model.flood.binding.IFloodModel"
               modelPath="models/flood.gml">
         </scenarioDatum>
      </dataSet>
   </extension>
   <extension
       id="org.kalypso.core.adapters"
       name="KalypsoFlood adapter factory"
         point="org.eclipse.core.runtime.adapters">
      <factory
            adaptableType="org.kalypsodeegree.model.feature.Feature"
            class="org.kalypso.model.flood.binding.KalypsoFloodAdapterFactory">
         <adapter
               type="org.kalypso.model.flood.binding.IFloodModel">
         </adapter>
         <adapter
               type="org.kalypso.model.flood.binding.IFloodPolygon">
         </adapter>
         <adapter
               type="org.kalypso.model.flood.binding.IFloodExtrapolationPolygon">
         </adapter>
         <adapter
               type="org.kalypso.model.flood.binding.IFloodClipPolygon">
         </adapter>
         <adapter
               type="org.kalypso.model.flood.binding.IFloodVolumePolygon">
         </adapter>
         <adapter
               type="org.kalypso.model.flood.binding.IRunoffEvent">
         </adapter>
         <adapter
               type="org.kalypso.model.flood.binding.ITinReference">
         </adapter>
      </factory>
   </extension>
   <extension
         point="org.eclipse.core.expressions.definitions">
      <definition id="org.kalypso.model.flood.expression.def.abstractFloodPolygonContextActive">
         <with variable="activeMapPanel">
           <test property="org.kalypso.ui.test.map.activeTheme.qname" value="{org.kalypso.model.flood}AbstractFloodPolygon" />
         </with>
      </definition>
   </extension>
   <extension
         point="org.eclipse.ui.commands">
      <command
            categoryId="org.kalypso.ogc.gml.map.category"
            id="org.kalypso.model.flood.command.createExtrapolationPolygon"
            name="Extrapolations-Polygon erzeugen" description="Extrapolations-Polygon erzeugen">
      </command>
      <command
            categoryId="org.kalypso.ogc.gml.map.category"
            id="org.kalypso.model.flood.command.createClipPolygon"
            name="Clip-Polygon erzeugen" description="Clip-Polygon erzeugen">
      </command>
      <command
            categoryId="org.kalypso.ogc.gml.map.category"
            id="org.kalypso.model.flood.command.createVolumePolygon"
            name="Volumen-Polygon erzeugen" description="Volumen-Polygon erzeugen">
      </command>
      <command
            categoryId="org.kalypso.ogc.gml.map.category"
            id="org.kalypso.model.flood.command.editFloodPolygon"
            name="WSP-Anpassung editieren" description="WSP-Anpassung editieren">
      </command>
      <command
            categoryId="org.kalypso.ogc.gml.map.category"
            id="org.kalypso.model.flood.command.deleteFloodPolygon"
            name="WSP-Anpassung entfernen" description="WSP-Anpassung entfernen">
      </command>
   </extension>
   <extension
         point="org.eclipse.ui.menus">
 		<menuContribution
              locationURI="toolbar:org.kalypso.ui.views.mapView?before=widgets">
           <!-- Flood-Polygons -->
           <command
                 commandId="org.kalypso.model.flood.command.createExtrapolationPolygon"
                 style="radio">
              <visibleWhen
                    checkEnabled="false">
                 <reference
                       definitionId="org.kalypso.model.flood.expression.def.abstractFloodPolygonContextActive">
                 </reference>
              </visibleWhen>
           </command>
           <command
                 commandId="org.kalypso.model.flood.command.createClipPolygon"
                 style="radio">
              <visibleWhen
                    checkEnabled="false">
                 <reference
                       definitionId="org.kalypso.model.flood.expression.def.abstractFloodPolygonContextActive">
                 </reference>
              </visibleWhen>
           </command>
           <command
                 commandId="org.kalypso.model.flood.command.createVolumePolygon"
                 style="radio">
              <visibleWhen
                    checkEnabled="false">
                 <reference
                       definitionId="org.kalypso.model.flood.expression.def.abstractFloodPolygonContextActive">
                 </reference>
              </visibleWhen>
           </command>
           <command
                 commandId="org.kalypso.model.flood.command.editFloodPolygon"
                 style="radio">
              <visibleWhen
                    checkEnabled="false">
                 <reference
                       definitionId="org.kalypso.model.flood.expression.def.abstractFloodPolygonContextActive">
                 </reference>
              </visibleWhen>
           </command>
           <command
                 commandId="org.kalypso.model.flood.command.deleteFloodPolygon"
                 style="radio">
              <visibleWhen
                    checkEnabled="false">
                 <reference
                       definitionId="org.kalypso.model.flood.expression.def.abstractFloodPolygonContextActive">
                 </reference>
              </visibleWhen>
           </command>
        </menuContribution>
	</extension>
   <extension
         point="org.eclipse.ui.newWizards">
      <category
            id="org.kalypso.model.flood.newwizard"
            name="Flood Model"
            parentCategory="org.kalypso.ui.newwizards.kalypso">
      </category>
      <wizard
            canFinishEarly="false"
            category="org.kalypso.ui.newwizards.kalypso/org.kalypso.model.flood.newwizard"
            class="org.kalypso.model.flood.ui.wizards.NewProjectWizard"
            descriptionImage="icons/button_flood.gif"
            finalPerspective="org.kalypso.kalypso1d2d.pjt.perspective.Perspective"
            hasPages="true"
            icon="icons//button_flood.gif"
            id="org.kalypso.model.flood.ui.wizards.NewProjectWizard"
            name="Kalypso Flood Model"
            project="true">
         <description>
            Erzeugt ein neues Flood-Modeller Projekt zur Generierung von Fliesstiefenkarten anhand zuvor berechneter Wasserspiegel.
         </description>
      </wizard>
      <wizard
            canFinishEarly="false"
            category="org.kalypso.ui.newwizards.kalypso/org.kalypso.model.flood.newwizard"
            class="org.kalypso.model.flood.ui.wizards.NewDemoProjectWizard"
            descriptionImage="icons//button_flood.gif"
            hasPages="true"
            icon="icons//button_flood.gif"
            id="org.kalypso.model.flood.ui.wizards.NewDemoProjectWizard"
            name="Kalypso Flood Model - Demo Projekt"
            project="true">
      </wizard>
   </extension>
   <extension
         point="org.kalypso.deegree.functionExpression">
      <function
            class="org.kalypso.model.flood.ui.map.EventFilterExpression"
            label="Event Filter"
            name="org.kalypso.model.flood.ui.map.EventFilterExpression">
      </function>
   </extension>
   <extension
         point="org.kalypso.core.gmlSourceProvider">
      <provider
            class="org.kalypso.model.flood.ui.map.ExternalFileGmlSourceProvider"
            id="org.kalypso.model.flood.ui.map.ExternalFileGmlSourceProvider"
            label="Externe Datei (.hmo, .shp, .gml)">
         <category
               id="org.kalypso.core.tin.waterlevel">
         </category>
      </provider>
   </extension>
   <extension
         point="org.kalypso.contribs.eclipseplatform.projectTemplate">
      <project
            category="org.kalypso.model.flood.projectTemplate"
            data="etc/projectTemplate.zip"
            description="Die leere Vorlage für Flood-Projekte"
            label="Leere Vorlage"
            projectName="">
      </project>
   </extension>
     <extension
         point="org.kalypso.afgui.kalypsoModule">
      <module
            module="org.kalypso.model.flood.extension.KalypsoModelFloodModule">
      </module>
   </extension>
     <extension point="org.eclipse.ui.commandImages">
        <!-- Flood-Polygons -->
        <image commandId="org.kalypso.model.flood.command.deleteFloodPolygon" icon="icons/elcl16/delete_flood_polygon.gif"/>
        <image commandId="org.kalypso.model.flood.command.editFloodPolygon" icon="icons/elcl16/edit_flood_polygon.gif"/>
        <image commandId="org.kalypso.model.flood.command.createExtrapolationPolygon" icon="icons/elcl16/create_flood_polygon_extrapolation.gif"/>
        <image commandId="org.kalypso.model.flood.command.createClipPolygon" icon="icons/elcl16/create_flood_polygon_clip.gif"/>
        <image commandId="org.kalypso.model.flood.command.createVolumePolygon" icon="icons/elcl16/create_flood_polygon_volume.gif"/>
     </extension>
</plugin>
