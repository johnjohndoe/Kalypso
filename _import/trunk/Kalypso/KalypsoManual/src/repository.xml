<?xml version="1.0" encoding="UTF-8"?>
<chapter id="zeitreihen_repository">
  <title>Zeitreihenbrowser</title>

  <indexterm>
    <primary>Zeitreihenbrowser</primary>
  </indexterm>

  <section>
    <title>Allgemein</title>

    <indexterm>
      <primary>Allgemeines</primary>
    </indexterm>

    <para>Zur Visualisierung von Zeitreihen ist in der KALYPSO-Oberfläche eine
    spezielle Perspektive vorgesehen: Der sogenannte KALYPSO
    Zeitreihenbrowser. Die Perspektive KALYPSO Zeitreihenbrowser gewährt den
    Zugang zur bzw. die Sicht auf die Zeitreihen-Quellen - wir sprechen in
    diesem Zusammenhang generell von der Zeitreihen-Ablage. Der
    Zeitreihenbrowser ist eng mit dem Expertenmodus verbunden und somit aus
    dem Anwendungsbetrieb (Assistenten-gesteuert) nicht zugänglich (siehe
    <xref linkend="anwendungsfaelle" />). Die Perspektive erscheint
    standardmäßig in der KALYPSO-Oberfläche des Experten, gleichgeordnet mit
    den Perspektiven KALYPSO Modeler und Hochwasser Vorhersage. Die
    Perspektive kann, sofern sie geschlossen wurde, über das Menü
    <guimenu>Fenster</guimenu> hinzugefügt werden (siehe <xref
    linkend="arbeiten_mit_ansichten" />).</para>

    <para>Die Funktion des Zeitreihenbrowsers besteht im Wesentlichen darin,
    die in externen Datenbanksystemen oder im Dateisystem vorliegenden
    Wasserstands-, Niederschlags- und Temperaturzeitreihen aus der
    KALYPSO-Oberfläche anzuschauen und zu kontrollieren. Die dabei in der
    aktuellen Zeitreihen-Ablage angezeigte Datenstruktur (Baumstruktur)
    entspricht so weit möglich Eins zu Eins der Datenstruktur auf
    Datenbank-Seite.</para>

    <para><note>
        <para>Der Zeitreihenbrowser ermöglicht ausdrücklich kein Editieren der
        Zeitreihen innerhalb der externen Datenbanksysteme (wie z.B. WISKI,
        PSICompact oder Ingres-Datacenter).</para>
      </note>Mit dem Zeitreihenbrowser besteht zudem die Möglichkeit, weitere
    Zeitreihen Repositories (Zeitreihen-Quellen) hinzuzufügen. Dabei kann es
    sich z.B. um Fremddaten oder historische Daten aus einer lokalen
    Datenquelle handeln. Voraussetzung ist allerdings, dass die in der
    Datenquelle enthaltenen Zeitreihen im ZML-Format vorliegen (siehe <xref
    linkend="gui_zml-import" />).</para>

    <para>Darüber hinaus stellt der Zeitreihenbrowser ein wichtiges
    Hilfsmittel beim Modellaufbau dar. Beispielsweise sind
    Niederschlagsstationen oder Wasserstandspegel mit Einzugsgebieten oder
    Berechnungsknoten in einem konkreten hydrologischen / hydraulischen Modell
    zu verknüpfen. Um diese Verknüpfung vorzunehmen, kann die Verknüpfung
    (Link) auf die Zeitreihe per rechten Mausklick in die Zwischenablage
    gespeichert und an der passenden Stelle in der entsprechenden Modelldatei
    eingefügt werden.</para>

    <para>Eine weitere Funktion des Zeitreihenbrowsers besteht im Datenexport.
    So können z.B. Zeitreihen aus einer Datenbank heruntergeladen und in ein
    beliebiges Verzeichnis im Netzwerk oder lokal gespeichert werden. Beim
    Export werden die Zeitreihen im ZML-Format abgelegt. Der Export von
    Zeitreihen ist in <xref linkend="repository_zeitreihenverwaltung" />
    beschrieben.</para>
  </section>

  <section id="repository_ansichten">
    <title>Ablagen-Ansicht</title>

    <indexterm>
      <primary>Ablagen-Ansicht</primary>
    </indexterm>

    <para>Bei Anwahl der Perspektive Zeitreihenbrowser über die entsprechende
    Schaltfläche öffnet sich die vordefinierte Ablagen-Ansicht (siehe <xref
    linkend="repository_ansicht" />). Auf der linken Seite befindet sich das
    Navigator-Fenster, in dem die ausgewählten Zeitreihen-Ablagen als
    Baumstruktur angezeigt werden. Zur Darstellung der Zeitreihen ist eine
    Tabellen- und eine Diagramm-Ansicht vorgesehen. Ist im Navigator-Fenster
    keine Zeitreihe markiert, sind die Tabelle und das Diagramm leer. Eine
    simultane Ansicht mehrerer Zeitreihen ist mit der Ablagen-Ansicht nicht
    möglich - die Zeitreihen können nur einzeln betrachtet werden.</para>

    <figure id="repository_ansicht">
      <title>Ansicht der Zeitreihen-Ablage</title>

      <mediaobject>
        <imageobject>
          <imagedata align="center"
                     fileref="img/repository/repository_gesamt.png"
                     scale="100" />
        </imageobject>
      </mediaobject>
    </figure>

    <para>Unten links unter dem Diagramm-Fenster ist das Eigenschaften-Fenster
    gezeigt, das die sogenannten Metadaten der Zeitreihe enthält. Eine
    Metadaten-Information kann z.B. der Stationsname sein. Die Metadaten sind
    typspezifisch, d.h., dass Niederschlagsstationen prinzipiell andere
    Metadaten enthalten können als Wasserstandspegel. Die einzelnen Zellen
    enthalten nicht immer einfache Werte, sondern es können auch komplexe
    Daten wie W/Q-Tabellen sein. Falls eine W/Q- oder eine W/V-Beziehung
    angegeben ist, wird im Diagramm und in der Tabelle neben der eigentlichen
    Zeitreihe auch die mithilfe der Beziehung generierte Zeitreihe
    dargestellt.</para>

    <para>Alle Fenster innerhalb der Ablagen-Ansicht können generell über das
    Menü <guimenu>Fenster</guimenu> geöffnet werden. Die einzelnen Fenster
    können vom Benutzer beliebig angeordnet und/oder verschoben werden. Es
    gelten die gleichen Optionen wie im Expertenmodus (siehe <xref
    linkend="arbeiten_mit_ansichten" />).</para>
  </section>

  <section id="repository_zeitreihenverwaltung">
    <title>Zeitreihenverwaltung</title>

    <indexterm>
      <primary>Zeitreihenverwaltung</primary>
    </indexterm>

    <para>Die Verwaltung der Zeitreihen-Ablagen erfolgt über Funktionen, die
    anhand von Schaltflächen in der oberen Leiste der Ablagen-Ansicht (siehe
    <xref linkend="repository_buttons" />) verfügbar sind. Hiermit kann der
    Benutzer Zeitreihen-Ablagen zur Ansicht hinzufügen, Zeitreihen-Ablagen aus
    der Ansicht entfernen oder die Einstellungen für eine Zeitreihen-Ablage
    ändern. Ein Speichern der Ablagen-Ansicht ist nicht notwendig. Alle
    Einstellungen werden automatisch beim Schließen von KALYPSO gespeichert
    und werden beim nächsten Programmstart wieder geladen.</para>

    <para>Im Einzelnen stehen die nachfolgend beschriebenen Funktionen zur
    Verfügung.</para>

    <figure id="repository_buttons">
      <title>Schaltflächen in der Ablagen-Ansicht</title>

      <mediaobject>
        <imageobject>
          <imagedata align="center"
                     fileref="img/repository/repository_schaltflaechen.png"
                     scale="70" />
        </imageobject>
      </mediaobject>
    </figure>

    <para><emphasis role="bold"><guilabel>Ablage(n)
    hinzufügen</guilabel></emphasis></para>

    <para>Der Benutzer kann beliebig viele Zeitreihen-Ablagen in der
    Oberfläche anmelden. Nach Auswahl der Schaltfläche erscheint ein
    Auswahlfenster, in dem zwischen lokalen und auf dem Server gespeicherten
    Zeitreihen-Ablagen gewählt werden kann.</para>

    <para>Sofern ein auf dem Server installiertes Datenbanksystem hinzugefügt
    werden muss, so ist die Option KALYPSO Zeitreihendienst auszuwählen.
    Dieser Dienst erkennt automatisch und installationsspezifisch welche
    relevante Datenbank auf dem Server verfügbar ist und verbindet diese mit
    KALYPSO.</para>

    <para>Wird eine lokale Ablage gewählt, muss im nächsten Fenster der Pfad,
    das Kennzeichen (Name der Ablage) sowie die Dateiendung der Zeitreihen
    (Standard: *.zml) angegeben werden (siehe <xref
    linkend="repository_import_lokal" /> ).</para>

    <figure id="repository_import_lokal">
      <title>Lokale Ablage hinzufügen</title>

      <mediaobject>
        <imageobject>
          <imagedata align="center"
                     fileref="img/repository/repository_import_lokal.png"
                     scale="100" />
        </imageobject>
      </mediaobject>
    </figure>

    <para><guilabel>Ablage entfernen</guilabel></para>

    <para>Mit dieser Schaltfläche wird eine Zeitreihen-Ablage aus der
    aktuellen Ansicht entfernt. Die entsprechenden Verzeichnisse (lokal oder
    auf dem Server) bleiben von diesem Löschvorgang jedoch physisch
    unangetastet.</para>

    <para><emphasis role="bold"><guilabel>Einstellungen der Ablage
    setzen</guilabel></emphasis></para>

    <para>Mit dieser Option kann der Zeitraum für die Abfrage und
    Visualisierung der Zeitreihen - für die jeweils markierte
    Zeitreihen-Ablage - definiert werden. Es erscheint ein Auswahlfenster, in
    dem der Benutzer den gewünschten Zeitraum der Betrachtung eingeben kann
    (siehe <xref linkend="repository_einstellungen" />).</para>

    <figure id="repository_einstellungen">
      <title>Definition der Einstellungen einer Ablage</title>

      <mediaobject>
        <imageobject>
          <imagedata align="center"
                     fileref="img/repository/repository_einstellungen.png"
                     scale="60" />
        </imageobject>
      </mediaobject>
    </figure>

    <para>Die Eingabe erfolgt entweder in Form der Anzahl der Tage oder durch
    Angabe des gewünschten Zeitraums.</para>

    <caution>
      <para>Wird bei der Anzahl der Tage <quote>0</quote> angegeben, werden
      alle Zeitreihen für den gesamten, in der Ablage zur Verfügung stehenden
      Zeitraum eingelesen, soweit dies von der jeweiligen Ablage unterstützt
      wird. Je nach zeitlicher Auflösung und Breite des zur Verfügung
      stehenden Zeitintervalls kann das Laden aller Zeitreihenwerte geraume
      Zeit in Anspruch nehmen.</para>
    </caution>

    <para><emphasis role="bold"><guilabel>Ablage
    aktualisieren</guilabel></emphasis></para>

    <para>Die Struktur, der in der Ansicht enthaltenen Zeitreihen-Ablagen,
    wird neu eingelesen.</para>

    <para><emphasis role="bold"><guilabel>Alle Zweige des Baums
    reduzieren</guilabel></emphasis></para>

    <para>Die Verzeichnisstruktur wird in der Ansicht bis auf die Überschrift
    reduziert (<quote>Zuklappen</quote>).</para>

    <para><emphasis role="bold"><guilabel>Datei in ein lokales Verzeichnis
    herunterladen</guilabel></emphasis></para>

    <para>Durch Klick auf die Schaltfläche im Zeitreihenbrowser (siehe <xref
    linkend="repository_export" />) kann die aktuell markierte Zeitreihe als
    Datei in ein beliebiges Verzeichnis gespeichert werden.</para>

    <figure id="repository_export">
      <title>Exportieren von Zeitreihen</title>

      <mediaobject>
        <imageobject>
          <imagedata align="center"
                     fileref="img/repository/repository_export_zeitreihen.png"
                     scale="60" />
        </imageobject>
      </mediaobject>
    </figure>

    <para>Es folgt eine Eingabe-Maske, in welcher der zu exportierende
    Zeitraum der Zeitreihe angegeben wird. Vom Programm wird ein Zeitraum von
    30 Tagen (vor der aktuellen Systemzeit) vorgegeben. Optional kann vom
    Benutzer auch ein fester Zeitraum eingegeben werden (siehe <xref
    linkend="repository_zeitraum" />).</para>

    <figure id="repository_zeitraum">
      <title>Definition des Zeitraums beim Export von Zeitreihen</title>

      <mediaobject>
        <imageobject>
          <imagedata align="center"
                     fileref="img/repository/repository_export_zeitreihen2.png"
                     scale="60" />
        </imageobject>
      </mediaobject>
    </figure>

    <para>Durch Klick auf <emphasis
    role="bold"><guilabel>Weiter</guilabel></emphasis> öffnet sich die
    Eingabemaske zur Vorgabe des Pfades und des Dateinamens, unter der die
    Zeitreihe abgespeichert werden soll. Mit Bestätigung durch Klick auf
    <emphasis role="bold"><guilabel>Fertig stellen</guilabel></emphasis> wird
    die Zeitreihe im vorgegebenen Verzeichnis gespeichert. Der Export erfolgt
    - unabhängig von der angegebenen Dateiendung - immer im ZML-Format.</para>
  </section>
</chapter>