<?xml version="1.0" encoding="UTF-8"?>
<chapter id="chapter_2_entwicklung">
  <title>Software-Entwicklung</title>

  <indexterm>
    <primary>Software-Entwicklung</primary>
  </indexterm>

  <para>Die Programmoberfläche und die Serverkomponente von KALYPSO wurden
  vollständig in der Programmiersprache Java entwickelt.</para>

  <section id="ide">
    <title>Umgebung und Werkzeuge</title>

    <indexterm>
      <primary>Software-Entwicklung</primary>

      <secondary>Umgebung und Werkzeuge</secondary>
    </indexterm>

    <para>In diesem Kapitel werden die zur Erstellung der Software verwendeten
    Entwicklungswerkzeuge beschrieben (siehe <xref
    linkend="tbl_develop_Entwicklungsumgebung" />). <table
        id="tbl_develop_Entwicklungsumgebung">
        <title>Entwicklungsumgebung</title>

        <tgroup cols="2">
          <colspec align="left" colwidth="1*" />

          <colspec align="left" colwidth="1*" />

          <thead>
            <row>
              <entry align="center">Umgebung/Werkzeug</entry>

              <entry align="center">Beschreibung</entry>
            </row>
          </thead>

          <tbody>
            <row>
              <entry>Java SDK 1.4.2</entry>

              <entry>Entwicklungs-Kit</entry>
            </row>

            <row>
              <entry>Java Web Service Dev Pack 1.4 - JAXB - JAX-RPC</entry>

              <entry>Bibliotheken für Java - XML Binding und Java basierte
              Webdienste</entry>
            </row>

            <row>
              <entry>Eclipse Platform 3.0.2</entry>

              <entry>Grundlage für den KALYPSO-Client</entry>
            </row>

            <row>
              <entry>Docbook - Xml 4.2 - Stylesheets 1.65.1</entry>

              <entry>XML-Anwendung für die Erstellung des
              Benutzerhandbuchs</entry>
            </row>

            <row>
              <entry>Eclipse 3.0.2</entry>

              <entry>Entwicklungsumgebung</entry>
            </row>

            <row>
              <entry>CVS</entry>

              <entry>Quellcode Verwaltung</entry>
            </row>

            <row>
              <entry>ANT 1.6</entry>

              <entry>Steuerung des Build-Prozesses</entry>
            </row>

            <row>
              <entry>Tomcat 5.0.28</entry>

              <entry>J2EE Container für die Webdienste</entry>
            </row>

            <row>
              <entry>Miktex 2.2 und DB2Latex 0.8pre1</entry>

              <entry>Konvertierung von DocBook nach LaTeX und anschließend
              nach PDF</entry>
            </row>

            <row>
              <entry>Xsltproc</entry>

              <entry>XSLT-Programm für die Transformation von XML anhand von
              Stylesheets</entry>
            </row>
          </tbody>
        </tgroup>
      </table></para>

    <para>Als Entwicklungsumgebung wurde die frei erhältliche Eclipse
    Plattform verwendet. Bis auf die Wahl des Sprach-Compliance-Levels auf
    Version 1.4 wurden in Eclipse keine speziellen Einstellungen
    vorgenommen.</para>

    <para>Das Erzeugen der verschiedenen Versionen des Anwenderhandbuchs
    (html, EclipseHelp, PDF) wurde komplett per ANT-Skript automatisiert. Es
    ist lediglich dafür zu sorgen, dass sich das zur Umwandlung von LaTeX noch
    PDF benötigte Programm pdflatex.exe (im Umfang der Miktex-Distribution
    enthalten) im aktuellen Programmpfad befindet sowie dass alle von DB2Latex
    benötigten LaTeX-Packages in der Miktex-Installation eingebunden
    sind.</para>
  </section>

  <section>
    <title>Programmaufbau</title>

    <indexterm>
      <primary>Programmaufbau</primary>
    </indexterm>

    <para>Der Programmaufbau wird in den beiden Teilen - Client und Server -
    beschrieben.</para>

    <section>
      <title>KALYPSO-Client</title>

      <indexterm>
        <primary>Programmaufbau</primary>

        <secondary>Client</secondary>
      </indexterm>

      <para>Clientseitig baut KALYPSO auf der Eclipse Plattform API auf:
      KALYPSO besteht aus einem Eclipse-Feature und einer Reihe von
      Eclipse-Plugins (siehe <xref
      linkend="tbl_develop_K_Features_Plugins" />).</para>

      <table id="tbl_develop_K_Features_Plugins">
        <title>KALYPSO Features und Plugins</title>

        <tgroup cols="3">
          <colspec align="left" colwidth="3*" />

          <colspec align="left" colwidth="1*" />

          <colspec align="left" colwidth="4*" />

          <thead>
            <row>
              <entry align="center">Bundle</entry>

              <entry align="center">Typ</entry>

              <entry align="center">Beschreibung</entry>
            </row>
          </thead>

          <tbody>
            <row>
              <entry>EclipsePlatformContributions</entry>

              <entry>Plugin</entry>

              <entry>Grundfunktionen</entry>
            </row>

            <row>
              <entry>EclipseRCPContributions</entry>

              <entry>Plugin</entry>

              <entry>Grundfunktionen</entry>
            </row>

            <row>
              <entry>JWSDPInstallation</entry>

              <entry>Plugin</entry>

              <entry>Grundfunktionen</entry>
            </row>

            <row>
              <entry>JavaApiContributions</entry>

              <entry>Plugin</entry>

              <entry>Grundfunktionen</entry>
            </row>

            <row>
              <entry>KalypsoAuth</entry>

              <entry>Plugin</entry>

              <entry>Authentifizierung</entry>
            </row>

            <row>
              <entry>KalypsoCommons</entry>

              <entry>Plugin</entry>

              <entry>Grundfunktionen</entry>
            </row>

            <row>
              <entry>KalypsoCore</entry>

              <entry>Plugin</entry>

              <entry>Grundfunktionen</entry>
            </row>

            <row>
              <entry>KalypsoDWD</entry>

              <entry>Plugin</entry>

              <entry>Verwaltung von DWD-Vorhersagen</entry>
            </row>

            <row>
              <entry>KalypsoDeegree</entry>

              <entry>Plugin</entry>

              <entry>Deegree-Projekt und KALYPSO-spezifische
              Erweiterungen</entry>
            </row>

            <row>
              <entry>KalypsoFeatureView</entry>

              <entry>Plugin</entry>

              <entry>Spezielle KALYPSO GML-Feature Ansicht</entry>
            </row>

            <row>
              <entry>KalypsoMetaDoc</entry>

              <entry>Plugin</entry>

              <entry>Grundbausteine für Metadaten und Dokumentenablage</entry>
            </row>

            <row>
              <entry>KalypsoProduct</entry>

              <entry>Plugin</entry>

              <entry>Branding</entry>
            </row>

            <row>
              <entry>KalypsoRepository</entry>

              <entry>Plugin</entry>

              <entry>Grundbausteine für Zeitreihenablage</entry>
            </row>

            <row>
              <entry>KalypsoServiceCoreClient</entry>

              <entry>Plugin</entry>

              <entry>Allgemeiner Client eines Webdienstes</entry>
            </row>

            <row>
              <entry>KalypsoServiceMetaDocClient</entry>

              <entry>Plugin</entry>

              <entry>Client des Metadatendienstes</entry>
            </row>

            <row>
              <entry>KalypsoServiceUserClient</entry>

              <entry>Plugin</entry>

              <entry>Client des Benutzerdienstes</entry>
            </row>

            <row>
              <entry>KalypsoSimulationUI</entry>

              <entry>Plugin</entry>

              <entry>Komponenten der Benutzeroberfläche</entry>
            </row>

            <row>
              <entry>KalypsoUI</entry>

              <entry>Plugin</entry>

              <entry>Komponenten der Benutzeroberfläche</entry>
            </row>

            <row>
              <entry>KalypsoManualGrafik</entry>

              <entry>Plugin</entry>

              <entry>Benutzerhandbuch für das Grafikprogramm</entry>
            </row>

            <row>
              <entry>KalypsoManual</entry>

              <entry>Plugin</entry>

              <entry>Benutzerhandbuch für KALYPSO</entry>
            </row>

            <row vendor="sachsen-anhalt">
              <entry>KalypsoFeatureSachsenAnhalt</entry>

              <entry>Feature</entry>

              <entry>Client Deploy</entry>
            </row>

            <row vendor="sachsen">
              <entry>KalypsoFeatureSachsen</entry>

              <entry>Feature</entry>

              <entry>Client Deploy</entry>
            </row>
          </tbody>
        </tgroup>
      </table>
    </section>

    <section id="kalypso-server">
      <title>KALYPSO-Server</title>

      <indexterm>
        <primary>Programmaufbau</primary>

        <secondary>Server</secondary>
      </indexterm>

      <para>Der KALYPSO-Server besteht aus Web-Diensten, die unter Apache
      Tomcat laufen. Fünf Dienste stehen den Clients zur Verfügung:</para>

      <itemizedlist>
        <listitem>
          <para>KalypsoUserService: liefert benutzerabhängige
          Berechtigungen,</para>
        </listitem>

        <listitem>
          <para>KalypsoCalcService: verwaltet den Start von Modellberechnungen
          und liefert Ergebnisse,</para>
        </listitem>

        <listitem>
          <para>KalypsoObsService: verwaltet die operativen Daten (<abbrev>z.
          B.</abbrev> Zeitreihen),</para>
        </listitem>

        <listitem>
          <para>KalypsoMetaDocService: erlaubt die Veröffentlichung von
          Dokumenten (<abbrev>z. B.</abbrev> Grafiken oder Tabellen),</para>
        </listitem>

        <listitem>
          <para>Benutzung von WebDAV: zentrale Konfigurationsdateien werden im
          sog. WebDAV-Verzeichnis abgelegt.</para>
        </listitem>
      </itemizedlist>
    </section>

    <section id="modelle-sst">
      <title>Modellplugins und Schnittstellenkomponenten</title>

      <indexterm>
        <primary>Programmaufbau</primary>

        <secondary>Plugins und Schnittstellen</secondary>
      </indexterm>

      <para><xref linkend="tbl_devlop_spez_Plugins" /> listet die sog.
      Modellplugins und die Schnittstellenkomponenten auf.</para>

      <!--PROFILING ANFANG-->

      <table id="tbl_devlop_spez_Plugins">
        <title>Spezielle Plugins</title>

        <tgroup cols="3">
          <colspec align="left" colwidth="2*" />

          <colspec align="left" colwidth="1*" />

          <colspec align="left" colwidth="3*" />

          <thead>
            <row>
              <entry align="center">Bundle</entry>

              <entry align="center">Typ</entry>

              <entry align="center">Beschreibung</entry>
            </row>
          </thead>

          <tbody>
            <row vendor="sachsen-anhalt">
              <entry>KalypsoModelSaale</entry>

              <entry>Plugin/Library</entry>

              <entry>Integration des Saalemodells in Form eines Plugins für
              die lokale Benutzung, und in Form einer Library für die
              serverseitige Benutzung.</entry>
            </row>

            <row vendor="sachsen-anhalt">
              <entry>KalypsoModelTubig</entry>

              <entry>Plugin/Library</entry>

              <entry>Integration des Bode- und Ilsemodells in Form eines
              Plugins für die lokale Benutzung und in Form einer Library für
              die serverseitige Benutzung.</entry>
            </row>

            <row vendor="sachsen-anhalt">
              <entry>KalypsoAdapterRobotron</entry>

              <entry>Plugin/Library</entry>

              <entry>Implementierung der Schnittstellenfunktionen zum
              IMS-Robotron in Form eines Plugins für die lokale Benutzung, und
              in Form einer Library für die serverseitige Benutzung.</entry>
            </row>

            <row vendor="sachsen-anhalt">
              <entry>KalypsoAdapterWiski</entry>

              <entry>Plugin/Library</entry>

              <entry>Implementierung der Schnittstellenfunktionen zum
              WiskiDataProvider in Form eines Plugins für die lokale
              Benutzung, und in Form einer Library für die serverseitige
              Benutzung.</entry>
            </row>

            <row vendor="sachsen">
              <entry>KalypsoModelSpree</entry>

              <entry>Plugin/Library</entry>

              <entry>Integration des Spreemodells in Form eines Plugins für
              die lokale Benutzung, und in Form einer Library für die
              serverseitige Benutzung.</entry>
            </row>

            <row vendor="sachsen">
              <entry>KalypsoModelNA</entry>

              <entry>Plugin/Library</entry>

              <entry>Integration des NA Modell der TUHH in Form eines Plugins
              für die lokale Benutzung, und in Form einer Library für die
              serverseitige Benutzung.</entry>
            </row>

            <row vendor="sachsen">
              <entry>KalypsoOptimize</entry>

              <entry>Plugin/Library</entry>

              <entry>Plugin zur Kapselung des Optimierungsalgorythmus für das
              Weiße-Elster Modell..</entry>
            </row>

            <row vendor="sachsen">
              <entry>KalypsoAdapterPSICompact</entry>

              <entry>Plugin/Library</entry>

              <entry>Implementierung der Schnittstellenfunktionen zu
              PSICompact in Form eines Plugins für die lokale Benutzung, und
              in Form einer Library für die serverseitige Benutzung.</entry>
            </row>
          </tbody>
        </tgroup>
      </table>

      <!--PROFILING ENDE-->
    </section>

    <section id="conf">
      <title>Konfigurationsmanagement</title>

      <indexterm>
        <primary>Programmaufbau</primary>

        <secondary>Konfigurationsmanagement</secondary>
      </indexterm>

      <para>Neben allgemeinen Code Konfigurationen werden spezielle
      Konfigurationseinheiten für die Integration von KALYPSO in die Umgebung
      der Hochwasservorhersagezentrale Sachsen-Anhalt benötigt. <xref
      linkend="tbl_develop_Konfig_Plugins" /> listet diese Module auf.</para>

      <para><table id="tbl_develop_Konfig_Plugins">
          <title>Konfigurationsmanagement-Plugins</title>

          <tgroup cols="3">
            <colspec align="left" colwidth="2*" />

            <colspec align="left" colwidth="1*" />

            <colspec align="left" colwidth="3*" />

            <thead>
              <row>
                <entry align="center">Bundle</entry>

                <entry align="center">Typ</entry>

                <entry align="center">Beschreibung</entry>
              </row>
            </thead>

            <tbody>
              <row>
                <entry>KalypsoAnt</entry>

                <entry>Library</entry>

                <entry>Bereitstellung von ANT-Tasks für die Integration als
                Jar in KalypsoUI</entry>
              </row>

              <row>
                <entry>KalypsoBuild</entry>

                <entry>Resource</entry>

                <entry>Standard Buildframework von KALYPSO</entry>
              </row>

              <row vendor="sachsen-anhalt">
                <entry>KalypsoConfSachsenAnhalt</entry>

                <entry>Resource</entry>

                <entry>Konfigurationsdateien und Server-Deploy</entry>
              </row>

              <row>
                <entry>KalypsoLocalCalculation</entry>

                <entry>Plugin</entry>

                <entry>Optionales Plugin, wenn eingebunden, besteht die
                Möglichkeit, die Modelle clientseitig zu berechnen</entry>
              </row>
            </tbody>
          </tgroup>
        </table></para>
    </section>
  </section>

  <section id="source">
    <title>Quellcode-Organisation</title>

    <indexterm>
      <primary>Quellcode</primary>

      <secondary>Organisation</secondary>
    </indexterm>

    <para>Der Java-Quellcode wird mit dem Versionierungssystem CVS verwaltet.
    Die API-Dokumentation des Quellcodes wurde mit Hilfe von Javadoc als HTML
    erstellt.</para>

    <para>Der Quellcode ist in verschiedene Projekte unterteilt. Jedes Projekt
    deckt definierte Anforderungen bzw. Funktionen ab und ist mit einer
    Code-Lizenz ausgestattet. Projekte können von anderen Projekten abhängig
    sein und können über sog. Libraries (Code-Bibliotheken) verfügen, die
    jeweils ihre eigene Lizenz besitzen.</para>

    <para>Jedes Projekt enthält eine <filename>readme.txt</filename> Datei,
    welche eine kurze Projektbeschreibung beinhaltet.</para>
  </section>

  <section id="scm">
    <title>Quellcode-Verwaltung und Lizenzierung</title>

    <indexterm>
      <primary>Quellcode</primary>

      <secondary>Verwaltung und Lizensierung</secondary>
    </indexterm>

    <para>Der Quellcode wird mit CVS verwaltet. Bei jedem Meilenstein wurde
    der Projektstand mittels eines CVS Tags gekennzeichnet.</para>

    <para>Die allgemeinen Teile des KALYPSO-Quellcodes sind unter der LGPL
    (Lesser Gnu Public Licence, siehe <ulink
    url="http://www.gnu.org">http://www.gnu.org</ulink>) freigegeben.</para>

    <para>Fremdbibliotheken wurden in jedem Projekt stets im Unterverzeichnis
    <filename>/lib</filename> abgelegt und sind dort mit der jeweiligen
    Lizenzierung versehen.</para>
  </section>

  <section id="compile">
    <title>Kompilation</title>

    <indexterm>
      <primary>Kompilation</primary>
    </indexterm>

    <para>Unter Benutzung von Eclipse wird der Quellcode inkrementell
    kompiliert. Für das Deployment werden ANT-Skripte benutzt, die den
    Quellcode separat kompilieren.</para>

    <para>Die ANT-Skripte sind nach dem Standard aus dem KalypsoBuild-Plugin
    aufgebaut und verfügen über die gleichen Targets. Manche Projekte
    benötigen generierte Klassen für das sog. XML-Binding. Dies wird auch
    durch entsprechende Targets in den ANT-Skripten berücksichtigt.</para>
  </section>

  <section id="deployment">
    <title>Deployment</title>

    <indexterm>
      <primary>Deployment</primary>
    </indexterm>

    <para vendor="sachsen-anhalt">Aus der Entwicklungsumgebung ist es möglich,
    die unterschiedlichen Dienste zu deployen. Das
    KalypsoConfSachsenAnhalt-Projekt deckt diese Aspekte ab und stellt
    unterschiedliche übergeordnete ANT-Skripte zur Automatisierung des
    Deploy-Prozess zur Verfügung.</para>

    <para>Man kann:</para>

    <itemizedlist>
      <listitem>
        <para>die Daten- und Konfigurationsverzeichnisse auf dem Server
        erstellen,</para>
      </listitem>

      <listitem>
        <para>die Dienste entweder direkt in den Tomcat deployen oder in
        Dateien archivieren (in diesem Fall wird ein manueller Vorgang
        benutzt, um die Dienste im Container zu installieren).</para>
      </listitem>
    </itemizedlist>

    <para vendor="">Das Eclipse-Feature <!--PROFILING ANFANG sachsen-anhalt--><filename
    vendor="sachsen-anhalt">KalypsoFeatureSachsenAnhalt</filename><!--PROFILING ENDE und ANFANG sachsen--><filename
    vendor="sachsen">KalypsoFeatureSachsen</filename><!--PROFILING ENDE-->
    wird benutzt, um den KALYPSO-Client zu deployen. Ein Eclipse-Export als
    Feature ist direkt möglich. Somit werden die zahlreichen KALYPSO-Plugins
    berücksichtigt. Einfaches Kopieren reicht, um die Applikation zu
    aktualisieren. Dies setzt aber voraus, dass eine bestehende
    KALYPSO-Client-Umgebung vorbereitet ist. Mehr dazu im <xref
    linkend="chapter_3_installation" />.</para>
  </section>
</chapter>