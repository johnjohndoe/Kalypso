<?xml version="1.0" encoding="UTF-8"?>
<chapter id="chapter_2_entwicklung">
	<title>Software-Entwicklung</title>
	
	<para>Die Programmoberfläche und die Serverkomponente von KALYPSO wurden vollständig
		in der Programmiersprache Java entwickelt.</para>
	
	<para vendor="sachsen-anhalt">TODO: ein Wort über das TubigModell aus Entwickler
		Sicht</para>
	
	<para vendor="sachsen-anahlt">TODO: ein Wort über das SaaleModell aus Entwickler
		Sicht</para>
	
	<section id="ide">
		<title>Umgebung und Werkzeuge</title>
		
		<para>In diesem Kapitel werden die zur Erstellung der Software verwendeten
			Entwicklungswerkzeuge beschrieben.</para>
		
		<para><table>
			<title>Entwicklungsumgebung</title>
			
			<tgroup cols="2">
				<colspec align="left" colwidth="1*"/>
				
				<colspec align="left" colsep="1*"/>
				
				<thead>
					<row>
						<entry align="center">Umgebung/Werkzeug</entry>
						
						<entry align="center">Beschreibung</entry>
					</row>
				</thead>
				
				<tbody>
					<row>
						<entry>Java SDK 1.4.2</entry>
						
						<entry>Entwicklungs-Kit</entry>
					</row>
					
					<row>
						<entry>Java Web Service Dev Pack 1.4 - JAXB - JAX-RPC</entry>
						
						<entry>Bibliotheken für Java - XML Binding und Java basierte
							Webdienste</entry>
					</row>
					
					<row>
						<entry>Eclipse Platform 3.0.2</entry>
						
						<entry>Grundlage für den KALYPSO-Client</entry>
					</row>
					
					<row>
						<entry>Docbook - Xml 4.2 - Stylesheets 1.65.1</entry>
						
						<entry>XML-Anwendung für die Erstellung des
							Benutzerhandbuchs</entry>
					</row>
					
					<row>
						<entry>Eclipse 3.0.2</entry>
						
						<entry>Entwicklungsumgebung</entry>
					</row>
					
					<row>
						<entry>CVS</entry>
						
						<entry>Quellcode Verwaltung</entry>
					</row>
					
					<row>
						<entry>Ant 1.6</entry>
						
						<entry>Steuerung des Build-Prozesses</entry>
					</row>
					
					<row>
						<entry>Tomcat 5.0.28</entry>
						
						<entry>J2EE Container für die Webdienste</entry>
					</row>
					
					<row>
						<entry>Miktex und DB2Latex</entry>
						
						<entry>Konvertierung von DocBook nach Latex und anschließend
							nach PDF</entry>
					</row>
					
					<row>
						<entry>Xsltproc</entry>
						
						<entry>XSLT-Programm für die Transformation von XML anhand von
							Stylesheets</entry>
					</row>
				</tbody>
			</tgroup>
			</table> </para>
		
		<para>Als Entwicklungsumgebung wurde die frei erhältliche Eclipse-Platform
			verwendet. Bis auf die Wahl des Sprach-Compliance-Levels auf Version 1.4
			wurden in Eclipse keine speziellen Einstellungen gewählt.</para>
		
		<para>Das Erzeugen der verschiedenen Versionen des Anwenderhandbuchs (html,
			EclipseHelp, PDF) wurde komplett per Ant-Skript automatisiert. Es ist
			lediglich dafür zu sorgen, dass sich das zur Umwandlung Latex &gt; PDF benötigte
			Programm pdflatex.exe (im Umfang der Miktex-Distribution enthalten) im
			aktuellen Programmpfad befindet sowie dass alle von DB2Latex benötigten
			Latex-Packages in der Miktex-Installation eingebunden sind.</para>
	</section>
	
	<section>
		<title>Programmaufbau</title>
		
		<para>Der Programmaufbau wird in den beiden Teilen - Client und Server -
			beschrieben.</para>
		
		<section>
			<title>KALYPSO-Client</title>
			
			<para>Clientseitig baut KALYPSO auf der Eclipse Platform API auf: KALYPSO
				besteht aus eine sog. Eclipse-Feature und eine Reihe von sog.
				Eclipse-Plugins.</para>
			
			<table>
				<title>Kalypso Feature und Plugins</title>
				
				<tgroup cols="3">
					<colspec align="left" colwidth="2*"/>
					
					<colspec align="left" colwidth="1*"/>
					
					<colspec align="left" colwidth="2*"/>
					
					<thead>
						<row>
							<entry align="center">Bundle</entry>
							
							<entry align="center">Typ</entry>
							
							<entry align="center">Beschreibung</entry>
						</row>
					</thead>
					
					<tbody>
						<row>
							<entry>EclipsePlatformContributions</entry>
							
							<entry>Plugin</entry>
							
							<entry>Grundfunktionen</entry>
						</row>
						
						<row>
							<entry>EclipseRCPContributions</entry>
							
							<entry>Plugin</entry>
							
							<entry>Grundfunktionen</entry>
						</row>
						
						<row>
							<entry>JWSDPInstallation</entry>
							
							<entry>Plugin</entry>
							
							<entry>Grundfunktionen</entry>
						</row>
						
						<row>
							<entry>JavaApiContributions</entry>
							
							<entry>Plugin</entry>
							
							<entry>Grundfunktionen</entry>
						</row>
						
						<row>
							<entry>KalypsoAuth</entry>
							
							<entry>Plugin</entry>
							
							<entry>Authentifizierung</entry>
						</row>
						
						<row>
							<entry>KalypsoCommons</entry>
							
							<entry>Plugin</entry>
							
							<entry>Grundfunktionen</entry>
						</row>
						
						<row>
							<entry>KalypsoCore</entry>
							
							<entry>Plugin</entry>
							
							<entry>Grundfunktionen</entry>
						</row>
						
						<row>
							<entry>KalypsoDWD</entry>
							
							<entry>Plugin</entry>
							
							<entry>Verwaltung von DWD-Vorhersagen</entry>
						</row>
						
						<row>
							<entry>KalypsoDeegree</entry>
							
							<entry>Plugin</entry>
							
							<entry>Deegree-Projekt und Kalypso-spezifische
								Erweiterungen</entry>
						</row>
						
						<row>
							<entry>KalypsoFeatureView</entry>
							
							<entry>Plugin</entry>
							
							<entry>Spezielle Kalypso GML-Feature Ansicht</entry>
						</row>
						
						<row>
							<entry>KalypsoMetaDoc</entry>
							
							<entry>Plugin</entry>
							
							<entry>Grundbausteine für Metadaten und
								Dokumentenablage</entry>
						</row>
						
						<row>
							<entry>KalypsoProduct</entry>
							
							<entry>Plugin</entry>
							
							<entry>Branding</entry>
						</row>
						
						<row>
							<entry>KalypsoRepository</entry>
							
							<entry>Plugin</entry>
							
							<entry>Grundbausteine für Zeitreihenablage</entry>
						</row>
						
						<row>
							<entry>KalypsoServiceCoreClient</entry>
							
							<entry>Plugin</entry>
							
							<entry>Allgemeiner Client eines Webdienstes</entry>
						</row>
						
						<row>
							<entry>KalypsoServiceMetaDocClient</entry>
							
							<entry>Plugin</entry>
							
							<entry>Client des Metadatendienstes</entry>
						</row>
						
						<row>
							<entry>KalypsoServiceUserClient</entry>
							
							<entry>Plugin</entry>
							
							<entry>Client des Benutzerdienstes</entry>
						</row>
						
						<row>
							<entry>KalypsoSimulationUI</entry>
							
							<entry>Plugin</entry>
							
							<entry>Komponenten der Benutzeroberfläche</entry>
						</row>
						
						<row>
							<entry>KalypsoUI</entry>
							
							<entry>Plugin</entry>
							
							<entry>Komponenten der Benutzeroberfläche</entry>
						</row>
						
						<row>
							<entry>KalypsoManualGrafik</entry>
							
							<entry>Plugin</entry>
							
							<entry>Benutzerhandbuch für das Grafikprogramm</entry>
						</row>
						
						<row>
							<entry>KalypsoManual</entry>
							
							<entry>Plugin</entry>
							
							<entry>Benutzerhandbuch für Kalypso</entry>
						</row>
						
						<row vendor="sachsen-anhalt">
							<entry>KalypsoFeatureSachsenAnhalt</entry>
							
							<entry>Feature</entry>
							
							<entry>Client Deploy</entry>
						</row>
						
						<row vendor="sachsen">
							<entry>KalypsoFeatureSachsen</entry>
							
							<entry>Feature</entry>
							
							<entry>Client Deploy</entry>
						</row>
					</tbody>
				</tgroup>
			</table>
		</section>
		
		<section id="kalypso-server">
			<title>Kalypso-Server</title>
			
			<para>Der Kalypso-Server besteht aus Web Diensten, die in einem J2EE Container
				(Apache Tomcat) laufen. Fünf Dienste stehen den Clients zur
				Verfügung:</para>
			
			<itemizedlist>
				<listitem>
					<para>KalypsoUserService: liefert benutzerabhängige
						Berechtigungen,</para>
				</listitem>
				<listitem>
					<para>KalypsoCalcService: verwaltet den Start von
						Modellberechnungen und liefert Ergebnisse,</para>
				</listitem>
				<listitem>
					<para>KalypsoObsService: verwaltet die operativen Daten,</para>
				</listitem>
				<listitem>
					<para>KalypsoMetaDocService: erlaubt die Veröffentlichung von
						Dokumenten (z.B. Grafiken oder Tabellen),</para>
				</listitem>
				<listitem>
					<para>Benutzung von WEBDAV: zentrale Konfigurationsdateien werden
						im sog. Webdav Verzeichnis abgelegt.</para>
				</listitem>
			</itemizedlist>
		</section>
		
		<section id="modelle-sst">
			<title>Modell- und Schnittstellenkomponenten</title>
			
			<para>Folgende Tabelle listet die sog. Modellplugins und die
				Schnittstellenkomponenten auf.</para>
			
			<table>
				<title>Spezielle Plugins</title>
				
				<tgroup cols="3">
					<colspec align="left" colwidth="1*"/>
					
					<colspec align="left" colwidth="1*"/>
					
					<colspec align="left" colwidth="2*"/>
					
					<thead>
						<row>
							<entry align="center">Bundle</entry>
							
							<entry align="center">Typ</entry>
							
							<entry align="center">Beschreibung</entry>
						</row>
					</thead>
					
					<tbody>
						<row vendor="sachsen-anhalt">
							<entry>KalypsoModelSaale</entry>
							
							<entry>Plugin/Library</entry>
							
							<entry>Integration des Saalemodells in Form eines Plugins
								für die lokale Benutzung, und in Form einer Library für
								die Serverseitige Benutzung.</entry>
						</row>
						
						<row vendor="sachsen-anhalt">
							<entry>KalypsoModelTubig</entry>
							
							<entry>Plugin/Library</entry>
							
							<entry>Integration des Bode- und Ilsemodells in Form eines
								Plugins für die lokale Benutzung, und in Form einer
								Library für die Serverseitige Benutzung.</entry>
						</row>
						
						<row vendor="sachsen-anhalt">
							<entry>KalypsoAdapterRobotron</entry>
							
							<entry>Plugin/Library</entry>
							
							<entry>Implementierung der Schnittstellenfunktionen zum
								IMS-Robotron in Form eines Plugins für die lokale
								Benutzung, und in Form einer Library für die
								Serverseitige Benutzung.</entry>
						</row>
						
						<row vendor="sachsen-anhalt">
							<entry>KalypsoAdapterWiski</entry>
							
							<entry>Plugin/Library</entry>
							
							<entry>Implementierung der Schnittstellenfunktionen zum
								WiskiDataProvider in Form eines Plugins für die lokale
								Benutzung, und in Form einer Library für die
								Serverseitige Benutzung.</entry>
						</row>
					</tbody>
				</tgroup>
			</table>
		</section>
		
		<section id="conf">
			<title>Konfigurationsmanagement</title>
			
			<para>Neben allgemeinen Code Konfigurationen werden spezielle
				Konfigurationseinheiten für die Integration von Kalypso in die Umgebung
				der Hochwasserzentrale Sachsen-Anhalt benötigt. Folgende Tabelle
				listet diese Module auf:</para>
			
			<para>
				<table>
					<title>Konfigurationsmanagement-Plugins</title>
					
					<tgroup cols="3">
						<colspec align="left" colwidth="1*"/>
						
						<colspec align="left" colwidth="1*"/>
						
						<colspec align="left" colwidth="2*"/>
						
						<thead>
							<row>
								<entry align="center">Bundle</entry>
								
								<entry align="center">Typ</entry>
								
								<entry align="center">Beschreibung</entry>
							</row>
						</thead>
						
						<tbody>
							<row>
								<entry>KalypsoAnt</entry>
								
								<entry>Library</entry>
								
								<entry>Bereitstellung von Ant-Tasks für die
									Integration als Jar in KalypsoUI</entry>
							</row>
							
							<row>
								<entry>KalypsoBuild</entry>
								
								<entry>Resource</entry>
								
								<entry>Standard Buildframework von Kalypso</entry>
							</row>
							
							<row vendor="sachsen-anhalt">
								<entry>KalypsoConfSachsenAnhalt</entry>
								
								<entry>Resource</entry>
								
								<entry>Konfigurationsdateien und
									Server-Deploy</entry>
							</row>
							
							<row>
								<entry>KalypsoLocalCalculation</entry>
								
								<entry>Plugin</entry>
								
								<entry>Optionales Plugin, wenn eingebunden besteht
									die Möglichkeit des clientseitiges
									Berechnen</entry>
							</row>
						</tbody>
					</tgroup>
				</table></para>
		</section>
	</section>
	
	<section id="source">
		<title>Quellcode-Organisation</title>
		
		<para>Der Java-Quellcode wird mit dem Versionierungssystem CVS verwaltet. Die
			Dokumentation des Quellcodes wurde mit Hilfe von Javadoc erstellt. Sie können
			durch diese Dokumentation mit einem Webbrowser navigieren.</para>
		
		<para>Der Quellcode ist in verschiedene Projekte unterteilt. Jedes Projekt deckt
			definierte Anforderungen bzw. Funktionen ab und ist mit einer Code-Lizenz
			ausgestattet. Projekte können von anderen Projekten abhängig sein und können
			über sog. Libraries (Code-Bibliotheken) verfügen, die jeweils ihre eigene
			Lizenz besitzen.</para>
		
		<para>Jedes Projekt enthält eine <filename>readme.txt</filename> Datei, welche
			eine kurze Projektbeschreibung beinhaltet.</para>
	</section>
	
	<section id="scm">
		<title>Quellcode-Verwaltung und Lizenzierung</title>
		
		<para>Der Quellcode wird mit CVS verwaltet. Bei jedem Meilenstein wurde der
			Projektstand mittels eines CVS Tags gekennzeichnet.</para>
		
		<para>Die allgemeinen Teile des Kalypso Quellcodes wurden unter der LGPL (Lesser
			Gnu Public Licence, siehe http://www.gnu.org/) freigegeben.</para>
		
		<para>Fremdbibliotheken wurden in jedem Projekt stets im Unterverzeichnis
			<filename>/lib</filename> abgelegt und sind dort mit der jeweiligen
			Lizenzierung versehen.</para>
	</section>
	
	<section id="compile">
		<title>Kompilation</title>
		
		<para>Unter Benutzung von Eclipse wird der Quellcode inkrementell kompiliert. Für
			das deployen werden Ant-Skripte benutzt die der Quellcode separat
			kompiliert.</para>
		
		<para>Die Ant-Skripte sind nach dem Standard aus dem KalypsoBuild-Plugin
			aufgebaut und verfügen über die gleiche Targets. Manche Projekte benötigen
			generierte Klassen für das sog. XML-Binding. Dies wird auch durch
			entsprechende Targets in die Ant-Skripten berücksichtigt.</para>
	</section>
	
	<section id="deployment">
		<title>Deployment</title>
		
		<para vendor="sachsen-anhalt">Aus der Entwicklungsumgebung ist es möglich, die
			unterschiedlichen Dienste zu deployen. Das
			KalypsoConfSachsenAnhalt-Projekt deckt diese Aspekte ab und stellt
			unterschiedliche übergeordnete Ant-Skripts zur Automatisierung des Deploy
			zur Verfügung.</para>
		
		<para>Man kann:</para>
		
		<itemizedlist>
			<listitem>
				<para>die Daten- und Konfigurationsverzeichnisse auf dem Server
					erstellen,</para>
			</listitem>
			<listitem>
				<para>die Dienste entweder direkt in den Container deployen oder in
					Dateien archivieren (in diesem Fall wird ein manueller Vorgang
					benutzt, um die Dienste im Container zu deployen).</para>
			</listitem>
		</itemizedlist>
		
		<para vendor="sachsen-anhalt">Um dem Kalypso-Client deployen zu können wird das
			KalypsoFeatureSachsenAnhalt benutzt. Ein Eclipse-Export als Feature ist
			direkt möglich. Somit werden die zahlreichen Kalypso-Plugins
			berücksichtigt. Einfaches Kopieren reicht um die Applikation zu
			aktualisieren. Dies setzt aber vorraus, dass eine bestehende Kalypso-Client
			Umgebung vorbereitet ist. Mehr dazu im <xref
				linkend="chapter_3_installation"/>.</para>
	</section>
</chapter>
