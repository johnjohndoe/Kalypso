<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.0"?>
<plugin>
   <extension
         point="org.eclipse.ui.popupMenus">
      <objectContribution
            adaptable="false"
            id="org.kalypso.model.wspm.objectContribution.calcTuhh"
            objectClass="org.kalypsodeegree.model.feature.Feature">
         <filter
               name="featureType"
               value="org.kalypso.model.wspm.tuhh#CalculationWspmTuhhSteadyState;org.kalypso.model.wspm.tuhh#CalculationReibConstWspmTuhhSteadyState"/>
         <action
               class="org.kalypso.model.wspm.tuhh.ui.actions.CalcTuhhAction"
               icon="icons/obj16/startCalulation.gif"
               id="org.kalypso.model.wspm.calcTuhhAction"
               label="%org.kalypso.model.wspm.calcTuhhAction"
               style="push"
               tooltip="%org.kalypso.model.wspm.calcTuhhAction.tooltip"/>
      </objectContribution>
      <objectContribution
            adaptable="false"
            id="org.kalypso.model.wspm.tuhh.ui.objectContribution.showProfile"
            objectClass="org.kalypsodeegree.model.feature.Feature">
         <filter
               name="featureType"
               value="org.kalypso.model.wspm.tuhh#ProfileReachSegmentWspmTuhhSteadyState"/>
         <action
               class="org.kalypso.model.wspm.ui.action.ShowProfileAction"
               icon="icons/obj16/openProfile.gif"
               id="org.kalypso.model.wspm.ui.action.ShowProfileAction"
               label="%org.kalypso.model.wspm.ui.action.ShowProfileAction"
               tooltip="%org.kalypso.model.wspm.ui.action.ShowProfileAction.description"/>
      </objectContribution>
            <objectContribution
            adaptable="false"
            id="org.kalypso.model.wspm.ui.object.contribution.org.kalypso.ui.editor.gmleditor.ui.feature.tuhhreach"
            objectClass="org.kalypsodeegree.model.feature.Feature">
         <filter
               name="featureType"
               value="org.kalypso.model.wspm.tuhh#ReachWspmTuhhSteadyState"/>
         <action
               class="org.kalypso.model.wspm.tuhh.ui.actions.CreateProfileMapAction"
               icon="icons/elcl16/createProfileMap.gif"
               id="org.kalypso.model.wspm.ui.action.CreateProfileMapAction"
               label="%org.kalypso.model.wspm.ui.action.CreateProfileMapAction"
               menubarPath="org.kalypso.model.wspm.ui.wspmProfileActions"
               style="push"
               tooltip="%org.kalypso.model.wspm.ui.action.CreateProfileMapAction.description"/>
      </objectContribution>
   </extension>

	<extension point="org.eclipse.ui.handlers">
		<handler commandId="org.kalypso.ui.map.outline.command.WspmCreateDevider" class="org.kalypso.model.wspm.ui.action.CreateDeviderHandler">
			<activeWhen>
				<reference definitionId="org.kalypso.model.wspm.tuhh.ui.definition.oneProfileThemeSelected"/>
			</activeWhen>
		</handler>
		<handler commandId="org.kalypso.ui.map.outline.command.WspmIntersectRoughnessMap" class="org.kalypso.model.wspm.ui.action.IntersectRoughnessHandler">
			<activeWhen>
				<reference definitionId="org.kalypso.model.wspm.tuhh.ui.definition.oneProfileThemeSelected"/>
			</activeWhen>
		</handler>
          <handler
                class="org.kalypso.model.wspm.tuhh.ui.export.csv.CsvExportProfilesHandler"
                commandId="org.kalypso.model.wspm.tuhh.ui.commands.exportProfilesCsv">
             <enabledWhen>
                <reference
                      definitionId="org.kalypso.model.wspm.ui.definition.selectionHasProfiles">
                </reference>
             </enabledWhen>
          </handler>
          <handler
                class="org.kalypso.model.wspm.tuhh.ui.export.SobekExportProfilesHandler"
                commandId="org.kalypso.model.wspm.tuhh.ui.commands.exportProfilesSobek">
             <enabledWhen>
                <reference
                      definitionId="org.kalypso.model.wspm.ui.definition.selectionHasProfiles">
                </reference>
             </enabledWhen>
          </handler>
          <handler
                class="org.kalypso.model.wspm.tuhh.ui.export.LngExportProfilesHandler"
                commandId="org.kalypso.model.wspm.tuhh.ui.commands.exportProfilesLng">
             <enabledWhen>
                <reference
                      definitionId="org.kalypso.model.wspm.ui.definition.selectionHasProfiles">
                </reference>
             </enabledWhen>
          </handler>
          <handler
                class="org.kalypso.model.wspm.tuhh.ui.export.PrfExportProfilesHandler"
                commandId="org.kalypso.model.wspm.tuhh.ui.commands.exportPrf">
             <enabledWhen>
                <reference
                      definitionId="org.kalypso.model.wspm.ui.definition.selectionHasProfiles">
                </reference>
             </enabledWhen>
          </handler>
          <handler
                class="org.kalypso.model.wspm.tuhh.ui.imports.ImportWProfHandler"
                commandId="org.kalypso.model.wspm.tuhh.ui.commands.importWProf">
                     <enabledWhen>
                        <with
                              variable="selection">
                               <iterate
                                     ifEmpty="false"
                                     operator="and">
                                  <test
                                        args="property"
                                        forcePluginActivation="false"
                                        property="org.kalypso.ui.test.gmleditor.qname"
                                        value="{org.kalypso.model.wspm}WaterBody">
                                  </test>
                               </iterate>
                        </with>
                     </enabledWhen>
          </handler>
          <handler
                class="org.kalypso.model.wspm.tuhh.ui.actions.CreateLengthSectionHandler"
                commandId="org.kalypso.model.wspm.ui.command.profile.LengthSectionExport">
             <enabledWhen>
                <reference
                      definitionId="org.kalypso.model.wspm.ui.definition.selectionHasProfiles">
                </reference>
             </enabledWhen>
          </handler>
          <handler
                class="org.kalypso.model.wspm.tuhh.ui.export.PlotterExportHandler"
                commandId="org.kalypso.model.wspm.ui.command.profile.openInPlotter">
             <enabledWhen>
                <reference
                      definitionId="org.kalypso.model.wspm.ui.definition.selectionHasProfiles">
                </reference>
             </enabledWhen>
          </handler>
          <handler
                class="org.kalypso.model.wspm.tuhh.ui.export.LengthSectionExportHandler"
                commandId="org.kalypso.model.wspm.ui.action.LengthSectionExport">
             <enabledWhen>
                <reference
                      definitionId="org.kalypso.chart.ui.chartEditorActive">
                </reference>
             </enabledWhen>
          </handler>
	</extension>

   <extension
         point="org.eclipse.ui.exportWizards">
      <wizard
            class="org.kalypso.model.wspm.tuhh.ui.wizards.WspWinExportWizard"
            icon="icons/obj16/wspwin.gif"
            id="org.kalypso.model.wspm.exportwizard.wspwin"
            name="%org.kalypso.model.wspm.exportwizard.wspwin">
            <description>
            %org.kalypso.model.wspm.exportwizard.wspwin.description
         </description>
      </wizard>
   </extension>

   <extension
         point="org.kalypso.model.wspm.core.validatorrule">
      <rule
            class="org.kalypso.model.wspm.tuhh.ui.rules.RuecksprungRule"
            description="%pasche.ruecksprung"
            id="pasche.ruecksprung"
            type="org.kalypso.model.wspm.tuhh.profiletype"/>
        <rule
              class="org.kalypso.model.wspm.tuhh.ui.rules.TrennerRule"
              description="%pasche.trenner"
              id="pasche.trenner"
              type="org.kalypso.model.wspm.tuhh.profiletype"/>
        <rule
              class="org.kalypso.model.wspm.tuhh.ui.rules.BrueckeRule"
              description="%pasche.bruecke"
              id="pasche.bruecke"
              type="org.kalypso.model.wspm.tuhh.profiletype"/>
        <rule
              class="org.kalypso.model.wspm.tuhh.ui.rules.WehrRule"
              description="%pasche.wehr"
              id="pasche.wehr"
              type="org.kalypso.model.wspm.tuhh.profiletype"/>
        <rule
              class="org.kalypso.model.wspm.tuhh.ui.rules.DoppelterPunktRule"
              description="%pasche.doppelterpunkt"
              id="pasche.doppelterpunkt"
              type="org.kalypso.model.wspm.tuhh.profiletype"/>
        <rule
              class="org.kalypso.model.wspm.tuhh.ui.rules.BewuchsRule"
              description="%pasche.bewuchs"
              id="pasche.bewuchs"
              type="org.kalypso.model.wspm.tuhh.profiletype"/>
        <rule
              class="org.kalypso.model.wspm.tuhh.ui.rules.RauheitRule"
              description="%pasche.rauheit"
              id="pasche.rauheit"
              type="org.kalypso.model.wspm.tuhh.profiletype"/>
        <rule
              class="org.kalypso.model.wspm.tuhh.ui.rules.DurchlassRule"
              description="%pasche.durchlass"
              id="pasche.durchlass"
              type="org.kalypso.model.wspm.tuhh.profiletype">
        </rule>
   </extension>
   <extension
         point="org.kalypso.core.catalogContribution">
      <catalogContribution
            class="org.kalypso.model.wspm.tuhh.ui.catalog.WspmTuhhFeatureTypeCatalogContribution"
            name="Wspm Tuhh Style Catalog"/>
   </extension>
   <extension
         point="org.eclipse.ui.newWizards">
      <wizard
            canFinishEarly="false"
            category="org.kalypso.ui.newwizards.kalypso/org.kalypso.wspm.ui"
            class="org.kalypso.model.wspm.tuhh.ui.wizards.NewWspmProjectWizard"
            descriptionImage="icons/wizban/kalypso32.gif"
            finalPerspective="org.kalypso.model.wspm.ui.product.WspmPerspectiveFactory"
            hasPages="true"
            icon="icons/obj16/kalypso16.gif"
            id="org.kalypso.model.wspm.tuhh.ui.wizards.NewProjectWizard"
            name="%org.kalypso.model.wspm.tuhh.ui.wizards.NewProjectWizard"
            project="true">

         <description>
            %org.kalypso.model.wspm.tuhh.ui.wizards.NewProjectWizard.description
         </description>
      </wizard>
      <wizard
            canFinishEarly="false"
            category="org.kalypso.ui.newwizards.kalypso/org.kalypso.wspm.ui"
            class="org.kalypso.model.wspm.tuhh.ui.wizards.NewProjectImportWspwinWizard"
            descriptionImage="icons/wizban/kalypso32.gif"
            finalPerspective="org.kalypso.model.wspm.ui.product.WspmPerspectiveFactory"
            hasPages="true"
            icon="icons/obj16/wspwin16.gif"
            id="org.kalypso.model.wspm.tuhh.ui.wizards.NewProjectImportWspwinWizard"
            name="%org.kalypso.model.wspm.tuhh.ui.wizards.NewProjectImportWspwinWizard"
            project="true">
         <description>
            %org.kalypso.model.wspm.tuhh.ui.wizards.NewProjectImportWspwinWizard.description
         </description>
      </wizard>
      <wizard
            canFinishEarly="false"
            category="org.kalypso.ui.newwizards.kalypso/org.kalypso.wspm.ui"
            class="org.kalypso.model.wspm.tuhh.ui.wizards.DemoProjectWizard"
            descriptionImage="icons/wizban/kalypso32.gif"
            finalPerspective="org.kalypso.model.wspm.ui.product.WspmPerspectiveFactory"
            hasPages="true"
            icon="icons/obj16/kalypso16.gif"
            id="org.kalypso.model.wspm.tuhh.ui.wizards.DemoProjectWizard"
            name="%org.kalypso.model.wspm.tuhh.ui.wizards.DemoProjectWizard"
            project="true">
      </wizard>
   </extension>
   <extension
         point="org.eclipse.ui.perspectiveExtensions">
      <perspectiveExtension targetID="org.kalypso.model.wspm.ui.product.WspmPerspectiveFactory">
         <newWizardShortcut id="org.kalypso.model.wspm.tuhh.ui.wizards.NewProjectWizard"/>
         <newWizardShortcut id="org.kalypso.model.wspm.tuhh.ui.wizards.NewProjectImportWspwinWizard"/>
      </perspectiveExtension>
   </extension>
   <extension
         point="org.kalypso.model.wspm.core.profileFeatureProvider">
      <profileFeatureProvider
            class="org.kalypso.model.wspm.tuhh.core.gml.TuhhSegmentProfileFeatureProvider"
            id="org.kalypso.model.wspm.tuhh.core.gml.TuhhSegmentProfileFeatureProvider"/>
   </extension>
   <extension
         point="org.kalypso.model.wspm.ui.profilChartLayerProvider">
      <profilLayerProvider
            id="org.kalypso.model.wspm.tuhh.ui.chart.TuhhProfilLayerProvider"
            profiletype="org.kalypso.model.wspm.tuhh.profiletype"
            provider="org.kalypso.model.wspm.tuhh.ui.chart.ProfilLayerProviderTuhh"/>
   </extension>
      <extension
         point="org.kalypso.ui.featureViewExtensionControl">
      <extensionControl
            class="org.kalypso.model.wspm.tuhh.ui.featureview.ReachSegmentsFeatureviewControlFactory"
            id="org.kalypso.model.wspm.tuhh.ui.featureview.ReachSegmentsFeatureviewControlFactory"/>
   </extension>
      <extension
            point="org.kalypso.core.gmlSourceProvider">
         <provider
               class="org.kalypso.model.wspm.tuhh.ui.wizards.WspTinProvider"
               description="%org.kalypso.ui.wizards.results.gmlsource.WspTinProvider.description"
               id="org.kalypso.ui.wizards.results.gmlsource.WspTinProvider"
               label="%org.kalypso.ui.wizards.results.gmlsource.WspTinProvider">
            <category
                  id="org.kalypso.core.tin.waterlevel">
            </category>
         </provider>
      </extension>
      <extension
            point="org.kalypso.model.wspm.core.reparatorrule">
         <reparator
               class="org.kalypso.model.wspm.tuhh.ui.resolutions.AddBewuchsResolution"
               id="org.kalypso.model.wspm.tuhh.ui.resolutions.AddBewuchsResolution"
               name="Bewuchs hinzufügen">
         </reparator>
         <reparator
               class="org.kalypso.model.wspm.tuhh.ui.resolutions.DelBewuchsResolution"
               id="org.kalypso.model.wspm.tuhh.ui.resolutions.DelBewuchsResolution"
               name="Bewuchs entfernen">
         </reparator>
         <reparator
               class="org.kalypso.model.wspm.tuhh.ui.resolutions.AddDeviderResolution"
               id="org.kalypso.model.wspm.tuhh.ui.resolutions.AddDeviderResolution"
               name="Marker einfügen">
         </reparator>
         <reparator
               class="org.kalypso.model.wspm.tuhh.ui.resolutions.MoveDeviderResolution"
               id="org.kalypso.model.wspm.tuhh.ui.resolutions.MoveDeviderResolution"
               name="Marker verschieben">
         </reparator>
         <reparator
               class="org.kalypso.model.wspm.tuhh.ui.resolutions.EditPointResolution"
               id="org.kalypso.model.wspm.tuhh.ui.resolutions.EditPointResolution"
               name="Werte ändern">
         </reparator>
         <reparator
               class="org.kalypso.model.wspm.tuhh.ui.resolutions.DelDeviderResolution"
               id="org.kalypso.model.wspm.tuhh.ui.resolutions.DelDeviderResolution"
               name="Marker löschen">
         </reparator>
         <reparator
               class="org.kalypso.model.wspm.tuhh.ui.resolutions.DelRoughnessResolution"
               id="org.kalypso.model.wspm.tuhh.ui.resolutions.DelRoughnessResolution"
               name="Rauheit entfernen">
         </reparator>
      </extension>
       <extension
         point="org.kalypso.project.database.client.kalypsoModule">
         <module
               module="org.kalypso.model.wspm.tuhh.ui.extension.KalypsoWspmTuhhModule">
         </module>
      </extension>

	<extension point="org.eclipse.core.expressions.definitions">
		<definition id="org.kalypso.model.wspm.tuhh.ui.definition.oneProfileThemeSelected">
			<with variable="selection">
				<and>
					<count value="1"/>
					<iterate ifEmpty="false" operator="and">
						<test property="org.kalypso.ui.test.theme.qname" value="{org.kalypso.model.wspm.tuhh}ProfileReachSegmentWspmTuhhSteadyState"/>
					</iterate>
				</and>
			</with>
		</definition>
	</extension>
	
	

<!-- Profile From DEM  -->

  <extension point="org.eclipse.ui.menus">
    <menuContribution
          locationURI="toolbar:org.eclipse.ui.main.toolbar?after=additions">
       <toolbar
             id="org.kalypso.model.wspm.ui.toolbars.ProfileToolbar">
	     <command
	           commandId="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand.CreateProfileFromDEM"
	           icon="icons/profil_from_dem.gif"
	           style="radio"
	           tooltip="%org.kalypso.model.wspm.ui.view.legend.CreateProfileFromDEM">
           	<visibleWhen checkEnabled="false">
				<and>
					<with variable="activeEditorId">
						<equals value="org.kalypso.ui.editor.mapeditor.GisMapEditor" />
					</with>
					<!--reference definitionId="mapContext" /-->
					<with variable="activeMapPanel">
						<test property="org.kalypso.ui.test.map.activeTheme.qname" value="{org.kalypso.model.wspmprofile}Profile" />
					</with>
				</and>
			</visibleWhen>
	     </command>
       </toolbar>
    </menuContribution>
    <menuContribution
          locationURI="popup:org.kalypso.model.wspm.ui.profileImport?after=additions">
       <command
             commandId="org.kalypso.model.wspm.tuhh.ui.commands.importWProf"
             style="push">
          <visibleWhen
                checkEnabled="true">
          </visibleWhen>
       </command>
    </menuContribution>
    <menuContribution
          locationURI="popup:org.kalypso.model.wspm.ui.profileExport?after=additions">
       <command
             commandId="org.kalypso.model.wspm.tuhh.ui.commands.exportPrf"
             style="push">
          <visibleWhen
                checkEnabled="true">
          </visibleWhen>
       </command>
       <command
             commandId="org.kalypso.model.wspm.ui.command.profile.openInPlotter"
             style="push">
          <visibleWhen
                checkEnabled="true">
          </visibleWhen>
       </command>
       <command
             commandId="org.kalypso.model.wspm.tuhh.ui.commands.exportProfilesLng"
             style="push">
          <visibleWhen
                checkEnabled="true">
          </visibleWhen>
       </command>
       <command
             commandId="org.kalypso.model.wspm.tuhh.ui.commands.exportProfilesSobek"
             style="push">
          <visibleWhen
                checkEnabled="true">
          </visibleWhen>
       </command>
       <command
             commandId="org.kalypso.model.wspm.tuhh.ui.commands.exportProfilesCsv"
             style="push">
          <visibleWhen
                checkEnabled="true">
          </visibleWhen>
       </command>
    </menuContribution>
    <menuContribution
          locationURI="popup:org.kalypso.model.wspm.ui.profileChange?after=additions">
       <command
             commandId="org.kalypso.model.wspm.ui.command.profile.LengthSectionExport"
             style="push">
          <visibleWhen
                checkEnabled="true">
          </visibleWhen>
       </command>
    </menuContribution>
    <menuContribution
          locationURI="toolbar:org.kalypso.chart.ui.editor.toolbar?after=additions">
       <command
             commandId="org.kalypso.model.wspm.ui.action.LengthSectionExport"
             style="push">
          <visibleWhen
                checkEnabled="true">
          </visibleWhen>
       </command>
    </menuContribution>
  </extension>


  <extension point="org.eclipse.ui.handlers">
    <handler
          commandId="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand.CreateProfileFromDEM">
          <class class="org.kalypso.ogc.gml.map.widgets.SelectWidgetHandler">
        	<parameter name="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand.widget" value="org.kalypso.model.wspm.tuhh.ui.wizards.CreateProfileFromDEMWidget" />
      	  </class>
  	  	<enabledWhen>
			<and>
				<!--reference definitionId="mapContext" /-->
				<with variable="activeMapPanel">
					<test property="org.kalypso.ui.test.map.activeTheme.qname" value="{org.kalypso.model.wspmprofile}Profile" />
				</with>
			</and>
		</enabledWhen>
   </handler>
  </extension>

  <extension point="org.eclipse.ui.commands">
    <command
          categoryId="org.kalypso.ogc.gml.map.category"
          id="org.kalypso.ogc.gml.map.widgets.SelectWidgetCommand.CreateProfileFromDEM"
          name="Create Profile">
    </command>
    <command
          description="Export points of selected profiles as comma separated values."
          id="org.kalypso.model.wspm.tuhh.ui.commands.exportProfilesCsv"
          name="Comma Separated Values (.csv)">
    </command>
    <command
          description="Export selected profiles to SOBEK ascii formats."
          id="org.kalypso.model.wspm.tuhh.ui.commands.exportProfilesSobek"
          name="SOBEK ASCII (.def)">
    </command>
    <command
          description="Exports the selected profiles as a length section in WspWin-Plotter format."
          id="org.kalypso.model.wspm.tuhh.ui.commands.exportProfilesLng"
          name="WspWin Plotter Length-Section (.lng)">
    </command>
    <command
          description="Exports the selected profiles as .prf files."
          id="org.kalypso.model.wspm.tuhh.ui.commands.exportPrf"
          name="WspWin Profiles (.prf)">
    </command>
    <command
          description="Imports points from a WProf-Shape and converts them into profiles."
          id="org.kalypso.model.wspm.tuhh.ui.commands.importWProf"
          name="WProf-Shape">
    </command>
    <command
          description="Converts the selected profiles to a length section."
          id="org.kalypso.model.wspm.ui.command.profile.LengthSectionExport"
          name="Length Section">
    </command>
    <command
          id="org.kalypso.model.wspm.ui.command.profile.openInPlotter"
          name="WspWin Plotter">
    </command>
    <command
	       id="org.kalypso.model.wspm.ui.action.LengthSectionExport"
	       name="Create Length-Section">
	</command>

  </extension>
  <extension
        point="de.openali.odysseus.chart.factory.LayerProvider">
     <provider
           class="org.kalypso.model.wspm.tuhh.ui.chart.LengthSectionLayerProvider"
           id="org.kalypso.model.wspm.tuhh.ui.chart.LengthSectionLayerProvider">
     </provider>
  </extension>
  <extension
        point="org.eclipse.ui.commandImages">
     <image
           commandId="org.kalypso.model.wspm.tuhh.ui.commands.exportProfilesCsv"
           icon="icons/elcl16/export_csv.gif">
     </image>
     <image
           commandId="org.kalypso.model.wspm.tuhh.ui.commands.exportProfilesSobek"
           icon="icons/elcl16/export_sobek.gif">
     </image>
     <image
           commandId="org.kalypso.model.wspm.tuhh.ui.commands.exportProfilesLng"
           icon="icons/elcl16/export_plotter.gif">
     </image>
     <image
           commandId="org.kalypso.model.wspm.tuhh.ui.commands.importWProf"
           icon="icons/elcl16/import_wprof.gif">
     </image>
     <image
           commandId="org.kalypso.model.wspm.tuhh.ui.commands.exportPrf"
           icon="icons/elcl16/export_prf.gif">
     </image>
     <image
           commandId="org.kalypso.model.wspm.ui.command.profile.LengthSectionExport"
           icon="icons/elcl16/profile_create_lengthSection.gif">
     </image>
     <image
           commandId="org.kalypso.model.wspm.ui.command.profile.openInPlotter"
           icon="icons/elcl16/export_plotter.gif">
     </image>
  </extension>

	
      
</plugin>
